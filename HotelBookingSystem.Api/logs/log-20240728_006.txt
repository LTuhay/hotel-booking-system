2024-07-28 14:07:00.372 -03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2024-07-28 14:07:00.609 -03:00 [WRN] Resource not found.
System.Collections.Generic.KeyNotFoundException: Hotel not found
   at HotelBookingSystem.Application.Services.HotelService.GetHotelByIdAsync(Int32 hotelId) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Application\Services\HotelService.cs:line 63
   at HotelBookingSystem.Api.Controllers.HotelController.GetHotelById(Int32 hotelId) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api\Controllers\HotelController.cs:line 35
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at HotelBookingSystem.Api.Middlewares.ErrorHandlingMiddleware.InvokeAsync(HttpContext httpContext) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api\Middlewares\ErrorHandlingMiddleware.cs:line 20
2024-07-28 14:22:54.920 -03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2024-07-28 14:22:55.150 -03:00 [INF] Executing command: SELECT "t"."HotelId", "t"."Address", "t"."Amenities", "t"."CityId", "t"."CreatedAt", "t"."Description", "t"."HotelType", "t"."Name", "t"."Owner", "t"."StarRating", "t"."ThumbnailUrl", "t"."UpdatedAt", "t0"."RoomId", "t0"."AdultCapacity", "t0"."ChildCapacity", "t0"."CreatedAt", "t0"."DiscountedPrice", "t0"."FeaturedDeal", "t0"."HotelId", "t0"."ImagesUrl", "t0"."PricePerNight", "t0"."RoomType", "t0"."UpdatedAt", "t0"."BookingId", "t0"."CheckInDate", "t0"."CheckOutDate", "t0"."HotelId0", "t0"."RoomId0", "t0"."SpecialRequests", "t0"."TotalPrice", "t0"."UserId", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM (
    SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
    FROM "Hotels" AS "h"
    WHERE "h"."HotelId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId" AS "HotelId0", "b"."RoomId" AS "RoomId0", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
    FROM "Rooms" AS "r"
    LEFT JOIN "Bookings" AS "b" ON "r"."RoomId" = "b"."RoomId"
) AS "t0" ON "t"."HotelId" = "t0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "t"."HotelId" = "g"."HotelId"
ORDER BY "t"."HotelId", "t0"."RoomId", "t0"."BookingId"
2024-07-28 14:22:55.517 -03:00 [INF] HTTP GET /api/hotel/7 responded 200 in 3244.3128 ms
2024-07-28 14:23:47.937 -03:00 [INF] Executing command: SELECT "t"."HotelId", "t"."Address", "t"."Amenities", "t"."CityId", "t"."CreatedAt", "t"."Description", "t"."HotelType", "t"."Name", "t"."Owner", "t"."StarRating", "t"."ThumbnailUrl", "t"."UpdatedAt", "t0"."RoomId", "t0"."AdultCapacity", "t0"."ChildCapacity", "t0"."CreatedAt", "t0"."DiscountedPrice", "t0"."FeaturedDeal", "t0"."HotelId", "t0"."ImagesUrl", "t0"."PricePerNight", "t0"."RoomType", "t0"."UpdatedAt", "t0"."BookingId", "t0"."CheckInDate", "t0"."CheckOutDate", "t0"."HotelId0", "t0"."RoomId0", "t0"."SpecialRequests", "t0"."TotalPrice", "t0"."UserId", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM (
    SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
    FROM "Hotels" AS "h"
    WHERE "h"."HotelId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId" AS "HotelId0", "b"."RoomId" AS "RoomId0", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
    FROM "Rooms" AS "r"
    LEFT JOIN "Bookings" AS "b" ON "r"."RoomId" = "b"."RoomId"
) AS "t0" ON "t"."HotelId" = "t0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "t"."HotelId" = "g"."HotelId"
ORDER BY "t"."HotelId", "t0"."RoomId", "t0"."BookingId"
2024-07-28 14:23:48.338 -03:00 [INF] HTTP GET /api/hotel/7 responded 200 in 2532.8573 ms
2024-07-28 14:25:49.752 -03:00 [INF] User profile is available. Using 'C:\Users\loren\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-07-28 14:25:50.240 -03:00 [INF] Now listening on: https://localhost:7288
2024-07-28 14:25:50.241 -03:00 [INF] Now listening on: http://localhost:5124
2024-07-28 14:25:50.243 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-07-28 14:25:50.244 -03:00 [INF] Hosting environment: Development
2024-07-28 14:25:50.244 -03:00 [INF] Content root path: C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api
2024-07-28 14:25:51.868 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2024-07-28 14:25:52.201 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 337.4012ms
2024-07-28 14:25:52.238 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2024-07-28 14:25:52.238 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2024-07-28 14:25:52.287 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 13780 application/javascript; charset=utf-8 48.7184ms
2024-07-28 14:25:52.338 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 100.516ms
2024-07-28 14:25:52.417 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2024-07-28 14:25:52.633 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 215.9465ms
2024-07-28 14:25:54.431 -03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/hotel/7 - application/json 251
2024-07-28 14:25:54.664 -03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 18:52:08', Current time (UTC): '28/7/2024 17:25:54'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2024-07-28 14:25:54.739 -03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 18:52:08', Current time (UTC): '28/7/2024 17:25:54'.
2024-07-28 14:25:54.745 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.HotelController.GetHotelById (HotelBookingSystem.Api)'
2024-07-28 14:25:54.790 -03:00 [INF] Route matched with {action = "GetHotelById", controller = "Hotel"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetHotelById(Int32) on controller HotelBookingSystem.Api.Controllers.HotelController (HotelBookingSystem.Api).
2024-07-28 14:25:57.116 -03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2024-07-28 14:25:57.280 -03:00 [INF] Executing command: SELECT "t"."HotelId", "t"."Address", "t"."Amenities", "t"."CityId", "t"."CreatedAt", "t"."Description", "t"."HotelType", "t"."Name", "t"."Owner", "t"."StarRating", "t"."ThumbnailUrl", "t"."UpdatedAt", "t0"."RoomId", "t0"."AdultCapacity", "t0"."ChildCapacity", "t0"."CreatedAt", "t0"."DiscountedPrice", "t0"."FeaturedDeal", "t0"."HotelId", "t0"."ImagesUrl", "t0"."PricePerNight", "t0"."RoomType", "t0"."UpdatedAt", "t0"."BookingId", "t0"."CheckInDate", "t0"."CheckOutDate", "t0"."HotelId0", "t0"."RoomId0", "t0"."SpecialRequests", "t0"."TotalPrice", "t0"."UserId", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM (
    SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
    FROM "Hotels" AS "h"
    WHERE "h"."HotelId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId" AS "HotelId0", "b"."RoomId" AS "RoomId0", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
    FROM "Rooms" AS "r"
    LEFT JOIN "Bookings" AS "b" ON "r"."RoomId" = "b"."RoomId"
) AS "t0" ON "t"."HotelId" = "t0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "t"."HotelId" = "g"."HotelId"
ORDER BY "t"."HotelId", "t0"."RoomId", "t0"."BookingId"
2024-07-28 14:25:57.357 -03:00 [INF] Executed DbCommand (61ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."HotelId", "t"."Address", "t"."Amenities", "t"."CityId", "t"."CreatedAt", "t"."Description", "t"."HotelType", "t"."Name", "t"."Owner", "t"."StarRating", "t"."ThumbnailUrl", "t"."UpdatedAt", "t0"."RoomId", "t0"."AdultCapacity", "t0"."ChildCapacity", "t0"."CreatedAt", "t0"."DiscountedPrice", "t0"."FeaturedDeal", "t0"."HotelId", "t0"."ImagesUrl", "t0"."PricePerNight", "t0"."RoomType", "t0"."UpdatedAt", "t0"."BookingId", "t0"."CheckInDate", "t0"."CheckOutDate", "t0"."HotelId0", "t0"."RoomId0", "t0"."SpecialRequests", "t0"."TotalPrice", "t0"."UserId", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM (
    SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
    FROM "Hotels" AS "h"
    WHERE "h"."HotelId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId" AS "HotelId0", "b"."RoomId" AS "RoomId0", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
    FROM "Rooms" AS "r"
    LEFT JOIN "Bookings" AS "b" ON "r"."RoomId" = "b"."RoomId"
) AS "t0" ON "t"."HotelId" = "t0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "t"."HotelId" = "g"."HotelId"
ORDER BY "t"."HotelId", "t0"."RoomId", "t0"."BookingId"
2024-07-28 14:25:57.675 -03:00 [INF] Executing OkObjectResult, writing value of type 'HotelBookingSystem.Application.DTO.HotelDTO.HotelResponse'.
2024-07-28 14:25:57.735 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.HotelController.GetHotelById (HotelBookingSystem.Api) in 2936.4421ms
2024-07-28 14:25:57.737 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.HotelController.GetHotelById (HotelBookingSystem.Api)'
2024-07-28 14:25:57.740 -03:00 [INF] HTTP GET /api/hotel/7 responded 200 in 3294.9294 ms
2024-07-28 14:25:57.750 -03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/hotel/7 - 200 null application/json; charset=utf-8 3318.7641ms
2024-07-28 14:26:33.563 -03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/hotel/7 - application/json 251
2024-07-28 14:26:33.575 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.HotelController.GetHotelById (HotelBookingSystem.Api)'
2024-07-28 14:26:33.578 -03:00 [INF] Route matched with {action = "GetHotelById", controller = "Hotel"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetHotelById(Int32) on controller HotelBookingSystem.Api.Controllers.HotelController (HotelBookingSystem.Api).
2024-07-28 14:26:33.651 -03:00 [INF] Executing command: SELECT "t"."HotelId", "t"."Address", "t"."Amenities", "t"."CityId", "t"."CreatedAt", "t"."Description", "t"."HotelType", "t"."Name", "t"."Owner", "t"."StarRating", "t"."ThumbnailUrl", "t"."UpdatedAt", "t0"."RoomId", "t0"."AdultCapacity", "t0"."ChildCapacity", "t0"."CreatedAt", "t0"."DiscountedPrice", "t0"."FeaturedDeal", "t0"."HotelId", "t0"."ImagesUrl", "t0"."PricePerNight", "t0"."RoomType", "t0"."UpdatedAt", "t0"."BookingId", "t0"."CheckInDate", "t0"."CheckOutDate", "t0"."HotelId0", "t0"."RoomId0", "t0"."SpecialRequests", "t0"."TotalPrice", "t0"."UserId", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM (
    SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
    FROM "Hotels" AS "h"
    WHERE "h"."HotelId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId" AS "HotelId0", "b"."RoomId" AS "RoomId0", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
    FROM "Rooms" AS "r"
    LEFT JOIN "Bookings" AS "b" ON "r"."RoomId" = "b"."RoomId"
) AS "t0" ON "t"."HotelId" = "t0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "t"."HotelId" = "g"."HotelId"
ORDER BY "t"."HotelId", "t0"."RoomId", "t0"."BookingId"
2024-07-28 14:26:33.658 -03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."HotelId", "t"."Address", "t"."Amenities", "t"."CityId", "t"."CreatedAt", "t"."Description", "t"."HotelType", "t"."Name", "t"."Owner", "t"."StarRating", "t"."ThumbnailUrl", "t"."UpdatedAt", "t0"."RoomId", "t0"."AdultCapacity", "t0"."ChildCapacity", "t0"."CreatedAt", "t0"."DiscountedPrice", "t0"."FeaturedDeal", "t0"."HotelId", "t0"."ImagesUrl", "t0"."PricePerNight", "t0"."RoomType", "t0"."UpdatedAt", "t0"."BookingId", "t0"."CheckInDate", "t0"."CheckOutDate", "t0"."HotelId0", "t0"."RoomId0", "t0"."SpecialRequests", "t0"."TotalPrice", "t0"."UserId", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM (
    SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
    FROM "Hotels" AS "h"
    WHERE "h"."HotelId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId" AS "HotelId0", "b"."RoomId" AS "RoomId0", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
    FROM "Rooms" AS "r"
    LEFT JOIN "Bookings" AS "b" ON "r"."RoomId" = "b"."RoomId"
) AS "t0" ON "t"."HotelId" = "t0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "t"."HotelId" = "g"."HotelId"
ORDER BY "t"."HotelId", "t0"."RoomId", "t0"."BookingId"
2024-07-28 14:26:33.676 -03:00 [INF] Executing OkObjectResult, writing value of type 'HotelBookingSystem.Application.DTO.HotelDTO.HotelResponse'.
2024-07-28 14:26:33.679 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.HotelController.GetHotelById (HotelBookingSystem.Api) in 99.0132ms
2024-07-28 14:26:33.682 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.HotelController.GetHotelById (HotelBookingSystem.Api)'
2024-07-28 14:26:33.685 -03:00 [INF] HTTP GET /api/hotel/7 responded 200 in 112.7881 ms
2024-07-28 14:26:33.688 -03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/hotel/7 - 200 null application/json; charset=utf-8 127.5138ms
2024-07-28 14:28:40.201 -03:00 [INF] User profile is available. Using 'C:\Users\loren\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-07-28 14:28:40.434 -03:00 [INF] Now listening on: https://localhost:7288
2024-07-28 14:28:40.435 -03:00 [INF] Now listening on: http://localhost:5124
2024-07-28 14:28:40.437 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-07-28 14:28:40.439 -03:00 [INF] Hosting environment: Development
2024-07-28 14:28:40.439 -03:00 [INF] Content root path: C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api
2024-07-28 14:28:41.158 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2024-07-28 14:28:41.412 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 258.1718ms
2024-07-28 14:28:41.442 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2024-07-28 14:28:41.442 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2024-07-28 14:28:41.459 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 13780 application/javascript; charset=utf-8 18.0112ms
2024-07-28 14:28:41.518 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 76.7757ms
2024-07-28 14:28:41.603 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2024-07-28 14:28:41.840 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 236.5276ms
2024-07-28 14:28:47.566 -03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/hotel/7 - application/json 251
2024-07-28 14:28:47.640 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.HotelController.GetHotelById (HotelBookingSystem.Api)'
2024-07-28 14:28:47.661 -03:00 [INF] Route matched with {action = "GetHotelById", controller = "Hotel"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetHotelById(Int32) on controller HotelBookingSystem.Api.Controllers.HotelController (HotelBookingSystem.Api).
2024-07-28 14:28:48.925 -03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2024-07-28 14:28:48.999 -03:00 [INF] Executing command: SELECT "t"."HotelId", "t"."Address", "t"."Amenities", "t"."CityId", "t"."CreatedAt", "t"."Description", "t"."HotelType", "t"."Name", "t"."Owner", "t"."StarRating", "t"."ThumbnailUrl", "t"."UpdatedAt", "t0"."RoomId", "t0"."AdultCapacity", "t0"."ChildCapacity", "t0"."CreatedAt", "t0"."DiscountedPrice", "t0"."FeaturedDeal", "t0"."HotelId", "t0"."ImagesUrl", "t0"."PricePerNight", "t0"."RoomType", "t0"."UpdatedAt", "t0"."BookingId", "t0"."CheckInDate", "t0"."CheckOutDate", "t0"."HotelId0", "t0"."RoomId0", "t0"."SpecialRequests", "t0"."TotalPrice", "t0"."UserId", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM (
    SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
    FROM "Hotels" AS "h"
    WHERE "h"."HotelId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId" AS "HotelId0", "b"."RoomId" AS "RoomId0", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
    FROM "Rooms" AS "r"
    LEFT JOIN "Bookings" AS "b" ON "r"."RoomId" = "b"."RoomId"
) AS "t0" ON "t"."HotelId" = "t0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "t"."HotelId" = "g"."HotelId"
ORDER BY "t"."HotelId", "t0"."RoomId", "t0"."BookingId"
2024-07-28 14:28:49.027 -03:00 [INF] Executed DbCommand (21ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."HotelId", "t"."Address", "t"."Amenities", "t"."CityId", "t"."CreatedAt", "t"."Description", "t"."HotelType", "t"."Name", "t"."Owner", "t"."StarRating", "t"."ThumbnailUrl", "t"."UpdatedAt", "t0"."RoomId", "t0"."AdultCapacity", "t0"."ChildCapacity", "t0"."CreatedAt", "t0"."DiscountedPrice", "t0"."FeaturedDeal", "t0"."HotelId", "t0"."ImagesUrl", "t0"."PricePerNight", "t0"."RoomType", "t0"."UpdatedAt", "t0"."BookingId", "t0"."CheckInDate", "t0"."CheckOutDate", "t0"."HotelId0", "t0"."RoomId0", "t0"."SpecialRequests", "t0"."TotalPrice", "t0"."UserId", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM (
    SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
    FROM "Hotels" AS "h"
    WHERE "h"."HotelId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId" AS "HotelId0", "b"."RoomId" AS "RoomId0", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
    FROM "Rooms" AS "r"
    LEFT JOIN "Bookings" AS "b" ON "r"."RoomId" = "b"."RoomId"
) AS "t0" ON "t"."HotelId" = "t0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "t"."HotelId" = "g"."HotelId"
ORDER BY "t"."HotelId", "t0"."RoomId", "t0"."BookingId"
2024-07-28 14:28:49.189 -03:00 [INF] Executing OkObjectResult, writing value of type 'HotelBookingSystem.Application.DTO.HotelDTO.HotelResponse'.
2024-07-28 14:28:49.218 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.HotelController.GetHotelById (HotelBookingSystem.Api) in 1551.5416ms
2024-07-28 14:28:49.224 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.HotelController.GetHotelById (HotelBookingSystem.Api)'
2024-07-28 14:28:49.227 -03:00 [INF] HTTP GET /api/hotel/7 responded 200 in 1652.4183 ms
2024-07-28 14:28:49.238 -03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/hotel/7 - 200 null application/json; charset=utf-8 1672.3056ms
2024-07-28 14:59:27.062 -03:00 [INF] User profile is available. Using 'C:\Users\loren\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-07-28 14:59:27.529 -03:00 [INF] Now listening on: https://localhost:7288
2024-07-28 14:59:27.531 -03:00 [INF] Now listening on: http://localhost:5124
2024-07-28 14:59:27.533 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-07-28 14:59:27.534 -03:00 [INF] Hosting environment: Development
2024-07-28 14:59:27.535 -03:00 [INF] Content root path: C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api
2024-07-28 14:59:29.917 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2024-07-28 14:59:30.441 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 541.0913ms
2024-07-28 14:59:30.480 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2024-07-28 14:59:30.489 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2024-07-28 14:59:30.498 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 13780 application/javascript; charset=utf-8 17.1417ms
2024-07-28 14:59:30.586 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 96.4375ms
2024-07-28 14:59:30.766 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2024-07-28 14:59:31.094 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 327.5911ms
2024-07-28 14:59:37.437 -03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/hotel/featured-deals - application/json 251
2024-07-28 14:59:37.717 -03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 02:27:49', Current time (UTC): '28/7/2024 17:59:37'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2024-07-28 14:59:37.831 -03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 02:27:49', Current time (UTC): '28/7/2024 17:59:37'.
2024-07-28 14:59:37.843 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.HotelController.GetFeaturedDeals (HotelBookingSystem.Api)'
2024-07-28 14:59:37.913 -03:00 [INF] Route matched with {action = "GetFeaturedDeals", controller = "Hotel"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFeaturedDeals(System.Nullable`1[System.Int32]) on controller HotelBookingSystem.Api.Controllers.HotelController (HotelBookingSystem.Api).
2024-07-28 14:59:40.217 -03:00 [WRN] Collection navigations are only considered null if their parent entity is null. Use 'Any' to check whether collection navigation 'Hotel.Rooms' is empty.
2024-07-28 14:59:40.589 -03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2024-07-28 14:59:40.733 -03:00 [INF] Executing command: SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt", "r0"."RoomId", "r0"."AdultCapacity", "r0"."ChildCapacity", "r0"."CreatedAt", "r0"."DiscountedPrice", "r0"."FeaturedDeal", "r0"."HotelId", "r0"."ImagesUrl", "r0"."PricePerNight", "r0"."RoomType", "r0"."UpdatedAt", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM "Hotels" AS "h"
LEFT JOIN "Rooms" AS "r0" ON "h"."HotelId" = "r0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "h"."HotelId" = "g"."HotelId"
WHERE EXISTS (
    SELECT 1
    FROM "Rooms" AS "r"
    WHERE "h"."HotelId" = "r"."HotelId" AND "r"."FeaturedDeal")
ORDER BY "h"."HotelId", "r0"."RoomId"
2024-07-28 14:59:40.783 -03:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt", "r0"."RoomId", "r0"."AdultCapacity", "r0"."ChildCapacity", "r0"."CreatedAt", "r0"."DiscountedPrice", "r0"."FeaturedDeal", "r0"."HotelId", "r0"."ImagesUrl", "r0"."PricePerNight", "r0"."RoomType", "r0"."UpdatedAt", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM "Hotels" AS "h"
LEFT JOIN "Rooms" AS "r0" ON "h"."HotelId" = "r0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "h"."HotelId" = "g"."HotelId"
WHERE EXISTS (
    SELECT 1
    FROM "Rooms" AS "r"
    WHERE "h"."HotelId" = "r"."HotelId" AND "r"."FeaturedDeal")
ORDER BY "h"."HotelId", "r0"."RoomId"
2024-07-28 14:59:41.045 -03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[HotelBookingSystem.Application.DTO.HotelDTO.HotelResponse, HotelBookingSystem.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-07-28 14:59:41.125 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.HotelController.GetFeaturedDeals (HotelBookingSystem.Api) in 3201.5164ms
2024-07-28 14:59:41.131 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.HotelController.GetFeaturedDeals (HotelBookingSystem.Api)'
2024-07-28 14:59:41.134 -03:00 [INF] HTTP GET /api/hotel/featured-deals responded 200 in 3687.2504 ms
2024-07-28 14:59:41.143 -03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/hotel/featured-deals - 200 null application/json; charset=utf-8 3706.4124ms
2024-07-28 15:13:07.940 -03:00 [INF] User profile is available. Using 'C:\Users\loren\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-07-28 15:13:08.330 -03:00 [INF] Now listening on: https://localhost:7288
2024-07-28 15:13:08.331 -03:00 [INF] Now listening on: http://localhost:5124
2024-07-28 15:13:08.332 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-07-28 15:13:08.333 -03:00 [INF] Hosting environment: Development
2024-07-28 15:13:08.334 -03:00 [INF] Content root path: C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api
2024-07-28 15:47:22.013 -03:00 [INF] User profile is available. Using 'C:\Users\loren\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-07-28 15:47:22.287 -03:00 [INF] Now listening on: https://localhost:7288
2024-07-28 15:47:22.289 -03:00 [INF] Now listening on: http://localhost:5124
2024-07-28 15:47:22.291 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-07-28 15:47:22.292 -03:00 [INF] Hosting environment: Development
2024-07-28 15:47:22.292 -03:00 [INF] Content root path: C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api
2024-07-28 15:47:23.512 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2024-07-28 15:47:23.965 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 464.3993ms
2024-07-28 15:47:24.010 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2024-07-28 15:47:24.011 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2024-07-28 15:47:24.025 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 13780 application/javascript; charset=utf-8 15.6482ms
2024-07-28 15:47:24.101 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 90.2608ms
2024-07-28 15:47:24.196 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2024-07-28 15:47:24.407 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 211.3099ms
2024-07-28 15:48:31.404 -03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/auth/login - application/json 72
2024-07-28 15:48:31.526 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.AuthController.Login (HotelBookingSystem.Api)'
2024-07-28 15:48:31.574 -03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(HotelBookingSystem.Application.DTO.UserDTO.UserLoginRequest) on controller HotelBookingSystem.Api.Controllers.AuthController (HotelBookingSystem.Api).
2024-07-28 15:48:33.844 -03:00 [INF] Executing command: SELECT "u"."UserId", "u"."Address", "u"."City", "u"."Country", "u"."DateOfBirth", "u"."Email", "u"."FirstName", "u"."LastName", "u"."PasswordHash", "u"."PhoneNumber", "u"."Role"
FROM "Users" AS "u"
WHERE "u"."Email" = @__email_0
LIMIT 1
2024-07-28 15:48:33.877 -03:00 [INF] Executed DbCommand (29ms) [Parameters=[@__email_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."Address", "u"."City", "u"."Country", "u"."DateOfBirth", "u"."Email", "u"."FirstName", "u"."LastName", "u"."PasswordHash", "u"."PhoneNumber", "u"."Role"
FROM "Users" AS "u"
WHERE "u"."Email" = @__email_0
LIMIT 1
2024-07-28 15:48:34.060 -03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-07-28 15:48:34.083 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.AuthController.Login (HotelBookingSystem.Api) in 2499.0527ms
2024-07-28 15:48:34.085 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.AuthController.Login (HotelBookingSystem.Api)'
2024-07-28 15:48:34.089 -03:00 [INF] HTTP POST /api/auth/login responded 200 in 2673.6186 ms
2024-07-28 15:48:34.097 -03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/auth/login - 200 null application/json; charset=utf-8 2692.6494ms
2024-07-28 15:49:00.506 -03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/booking/3 - null null
2024-07-28 15:49:00.586 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.BookingController.GetBookingDetails (HotelBookingSystem.Api)'
2024-07-28 15:49:00.598 -03:00 [INF] Route matched with {action = "GetBookingDetails", controller = "Booking"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetBookingDetails(Int32) on controller HotelBookingSystem.Api.Controllers.BookingController (HotelBookingSystem.Api).
2024-07-28 15:49:00.769 -03:00 [INF] Executing command: SELECT "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId", "p"."PaymentId", "p"."Amount", "p"."BookingId", "p"."PaymentDate", "p"."PaymentMethod", "p"."Status", "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt", "u"."UserId", "u"."Address", "u"."City", "u"."Country", "u"."DateOfBirth", "u"."Email", "u"."FirstName", "u"."LastName", "u"."PasswordHash", "u"."PhoneNumber", "u"."Role"
FROM "Bookings" AS "b"
LEFT JOIN "Payments" AS "p" ON "b"."BookingId" = "p"."BookingId"
INNER JOIN "Hotels" AS "h" ON "b"."HotelId" = "h"."HotelId"
INNER JOIN "Users" AS "u" ON "b"."UserId" = "u"."UserId"
WHERE "b"."BookingId" = @__bookingId_0
LIMIT 1
2024-07-28 15:49:00.775 -03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__bookingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId", "p"."PaymentId", "p"."Amount", "p"."BookingId", "p"."PaymentDate", "p"."PaymentMethod", "p"."Status", "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt", "u"."UserId", "u"."Address", "u"."City", "u"."Country", "u"."DateOfBirth", "u"."Email", "u"."FirstName", "u"."LastName", "u"."PasswordHash", "u"."PhoneNumber", "u"."Role"
FROM "Bookings" AS "b"
LEFT JOIN "Payments" AS "p" ON "b"."BookingId" = "p"."BookingId"
INNER JOIN "Hotels" AS "h" ON "b"."HotelId" = "h"."HotelId"
INNER JOIN "Users" AS "u" ON "b"."UserId" = "u"."UserId"
WHERE "b"."BookingId" = @__bookingId_0
LIMIT 1
2024-07-28 15:49:01.003 -03:00 [INF] Executing command: SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-28 15:49:01.008 -03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-28 15:49:01.096 -03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2024-07-28 15:49:01.113 -03:00 [INF] Executing command: SELECT "t"."HotelId", "t"."Address", "t"."Amenities", "t"."CityId", "t"."CreatedAt", "t"."Description", "t"."HotelType", "t"."Name", "t"."Owner", "t"."StarRating", "t"."ThumbnailUrl", "t"."UpdatedAt", "t0"."RoomId", "t0"."AdultCapacity", "t0"."ChildCapacity", "t0"."CreatedAt", "t0"."DiscountedPrice", "t0"."FeaturedDeal", "t0"."HotelId", "t0"."ImagesUrl", "t0"."PricePerNight", "t0"."RoomType", "t0"."UpdatedAt", "t0"."BookingId", "t0"."CheckInDate", "t0"."CheckOutDate", "t0"."HotelId0", "t0"."RoomId0", "t0"."SpecialRequests", "t0"."TotalPrice", "t0"."UserId", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM (
    SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
    FROM "Hotels" AS "h"
    WHERE "h"."HotelId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId" AS "HotelId0", "b"."RoomId" AS "RoomId0", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
    FROM "Rooms" AS "r"
    LEFT JOIN "Bookings" AS "b" ON "r"."RoomId" = "b"."RoomId"
) AS "t0" ON "t"."HotelId" = "t0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "t"."HotelId" = "g"."HotelId"
ORDER BY "t"."HotelId", "t0"."RoomId", "t0"."BookingId"
2024-07-28 15:49:01.117 -03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."HotelId", "t"."Address", "t"."Amenities", "t"."CityId", "t"."CreatedAt", "t"."Description", "t"."HotelType", "t"."Name", "t"."Owner", "t"."StarRating", "t"."ThumbnailUrl", "t"."UpdatedAt", "t0"."RoomId", "t0"."AdultCapacity", "t0"."ChildCapacity", "t0"."CreatedAt", "t0"."DiscountedPrice", "t0"."FeaturedDeal", "t0"."HotelId", "t0"."ImagesUrl", "t0"."PricePerNight", "t0"."RoomType", "t0"."UpdatedAt", "t0"."BookingId", "t0"."CheckInDate", "t0"."CheckOutDate", "t0"."HotelId0", "t0"."RoomId0", "t0"."SpecialRequests", "t0"."TotalPrice", "t0"."UserId", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM (
    SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
    FROM "Hotels" AS "h"
    WHERE "h"."HotelId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId" AS "HotelId0", "b"."RoomId" AS "RoomId0", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
    FROM "Rooms" AS "r"
    LEFT JOIN "Bookings" AS "b" ON "r"."RoomId" = "b"."RoomId"
) AS "t0" ON "t"."HotelId" = "t0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "t"."HotelId" = "g"."HotelId"
ORDER BY "t"."HotelId", "t0"."RoomId", "t0"."BookingId"
2024-07-28 15:49:01.150 -03:00 [INF] Executing OkObjectResult, writing value of type 'HotelBookingSystem.Application.DTO.BookingDTO.BookingResponse'.
2024-07-28 15:49:01.178 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.BookingController.GetBookingDetails (HotelBookingSystem.Api) in 576.3096ms
2024-07-28 15:49:01.181 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.BookingController.GetBookingDetails (HotelBookingSystem.Api)'
2024-07-28 15:49:01.183 -03:00 [INF] HTTP GET /api/booking/3 responded 200 in 674.1214 ms
2024-07-28 15:49:01.184 -03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/booking/3 - 200 null application/json; charset=utf-8 678.5048ms
2024-07-28 15:49:20.289 -03:00 [INF] User profile is available. Using 'C:\Users\loren\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-07-28 15:49:20.620 -03:00 [INF] Now listening on: https://localhost:7288
2024-07-28 15:49:20.621 -03:00 [INF] Now listening on: http://localhost:5124
2024-07-28 15:49:20.624 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-07-28 15:49:20.625 -03:00 [INF] Hosting environment: Development
2024-07-28 15:49:20.626 -03:00 [INF] Content root path: C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api
2024-07-28 15:49:22.614 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2024-07-28 15:49:22.888 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 280.9539ms
2024-07-28 15:49:22.927 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2024-07-28 15:49:22.927 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2024-07-28 15:49:22.954 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 13780 application/javascript; charset=utf-8 24.6739ms
2024-07-28 15:49:23.013 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 86.6955ms
2024-07-28 15:49:23.090 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2024-07-28 15:49:23.284 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 194.6889ms
2024-07-28 15:49:26.675 -03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/booking/3 - null null
2024-07-28 15:49:26.880 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.BookingController.GetBookingDetails (HotelBookingSystem.Api)'
2024-07-28 15:49:26.912 -03:00 [INF] Route matched with {action = "GetBookingDetails", controller = "Booking"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetBookingDetails(Int32) on controller HotelBookingSystem.Api.Controllers.BookingController (HotelBookingSystem.Api).
2024-07-28 15:49:29.175 -03:00 [INF] Executing command: SELECT "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId", "p"."PaymentId", "p"."Amount", "p"."BookingId", "p"."PaymentDate", "p"."PaymentMethod", "p"."Status", "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt", "u"."UserId", "u"."Address", "u"."City", "u"."Country", "u"."DateOfBirth", "u"."Email", "u"."FirstName", "u"."LastName", "u"."PasswordHash", "u"."PhoneNumber", "u"."Role"
FROM "Bookings" AS "b"
LEFT JOIN "Payments" AS "p" ON "b"."BookingId" = "p"."BookingId"
INNER JOIN "Hotels" AS "h" ON "b"."HotelId" = "h"."HotelId"
INNER JOIN "Users" AS "u" ON "b"."UserId" = "u"."UserId"
WHERE "b"."BookingId" = @__bookingId_0
LIMIT 1
2024-07-28 15:49:29.207 -03:00 [INF] Executed DbCommand (24ms) [Parameters=[@__bookingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId", "p"."PaymentId", "p"."Amount", "p"."BookingId", "p"."PaymentDate", "p"."PaymentMethod", "p"."Status", "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt", "u"."UserId", "u"."Address", "u"."City", "u"."Country", "u"."DateOfBirth", "u"."Email", "u"."FirstName", "u"."LastName", "u"."PasswordHash", "u"."PhoneNumber", "u"."Role"
FROM "Bookings" AS "b"
LEFT JOIN "Payments" AS "p" ON "b"."BookingId" = "p"."BookingId"
INNER JOIN "Hotels" AS "h" ON "b"."HotelId" = "h"."HotelId"
INNER JOIN "Users" AS "u" ON "b"."UserId" = "u"."UserId"
WHERE "b"."BookingId" = @__bookingId_0
LIMIT 1
2024-07-28 15:49:29.517 -03:00 [INF] Executing OkObjectResult, writing value of type 'HotelBookingSystem.Application.DTO.BookingDTO.BookingResponse'.
2024-07-28 15:49:29.558 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.BookingController.GetBookingDetails (HotelBookingSystem.Api) in 2637.9815ms
2024-07-28 15:49:29.560 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.BookingController.GetBookingDetails (HotelBookingSystem.Api)'
2024-07-28 15:49:29.566 -03:00 [INF] HTTP GET /api/booking/3 responded 200 in 2880.2234 ms
2024-07-28 15:49:29.575 -03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/booking/3 - 200 null application/json; charset=utf-8 2900.3396ms
2024-07-28 17:00:04.982 -03:00 [INF] User profile is available. Using 'C:\Users\loren\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-07-28 17:00:05.505 -03:00 [INF] Now listening on: https://localhost:7288
2024-07-28 17:00:05.507 -03:00 [INF] Now listening on: http://localhost:5124
2024-07-28 17:00:05.510 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-07-28 17:00:05.511 -03:00 [INF] Hosting environment: Development
2024-07-28 17:00:05.512 -03:00 [INF] Content root path: C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api
2024-07-28 17:00:07.254 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2024-07-28 17:00:07.904 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 661.8246ms
2024-07-28 17:00:07.994 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2024-07-28 17:00:08.012 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 13780 application/javascript; charset=utf-8 17.5709ms
2024-07-28 17:00:08.014 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2024-07-28 17:00:08.191 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 177.1386ms
2024-07-28 17:00:08.304 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2024-07-28 17:00:08.515 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 212.1676ms
2024-07-28 17:00:26.291 -03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/auth/login - application/json 72
2024-07-28 17:00:26.418 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.AuthController.Login (HotelBookingSystem.Api)'
2024-07-28 17:00:26.472 -03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(HotelBookingSystem.Application.DTO.UserDTO.UserLoginRequest) on controller HotelBookingSystem.Api.Controllers.AuthController (HotelBookingSystem.Api).
2024-07-28 17:00:28.748 -03:00 [INF] Executing command: SELECT "u"."UserId", "u"."Address", "u"."City", "u"."Country", "u"."DateOfBirth", "u"."Email", "u"."FirstName", "u"."LastName", "u"."PasswordHash", "u"."PhoneNumber", "u"."Role"
FROM "Users" AS "u"
WHERE "u"."Email" = @__email_0
LIMIT 1
2024-07-28 17:00:28.784 -03:00 [INF] Executed DbCommand (27ms) [Parameters=[@__email_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."Address", "u"."City", "u"."Country", "u"."DateOfBirth", "u"."Email", "u"."FirstName", "u"."LastName", "u"."PasswordHash", "u"."PhoneNumber", "u"."Role"
FROM "Users" AS "u"
WHERE "u"."Email" = @__email_0
LIMIT 1
2024-07-28 17:00:28.964 -03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-07-28 17:00:28.981 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.AuthController.Login (HotelBookingSystem.Api) in 2498.0658ms
2024-07-28 17:00:28.983 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.AuthController.Login (HotelBookingSystem.Api)'
2024-07-28 17:00:28.988 -03:00 [INF] HTTP POST /api/auth/login responded 200 in 2687.3171 ms
2024-07-28 17:00:28.998 -03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/auth/login - 200 null application/json; charset=utf-8 2706.7059ms
2024-07-28 17:00:48.859 -03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/booking - application/json 183
2024-07-28 17:00:48.929 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.BookingController.CreateBooking (HotelBookingSystem.Api)'
2024-07-28 17:00:48.936 -03:00 [INF] Route matched with {action = "CreateBooking", controller = "Booking"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateBooking(HotelBookingSystem.Application.DTO.BookingDTO.BookingRequest) on controller HotelBookingSystem.Api.Controllers.BookingController (HotelBookingSystem.Api).
2024-07-28 17:00:55.049 -03:00 [INF] Executing command: SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-28 17:00:55.059 -03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-28 17:00:55.176 -03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2024-07-28 17:00:55.183 -03:00 [INF] Executing command: SELECT "t"."HotelId", "t"."Address", "t"."Amenities", "t"."CityId", "t"."CreatedAt", "t"."Description", "t"."HotelType", "t"."Name", "t"."Owner", "t"."StarRating", "t"."ThumbnailUrl", "t"."UpdatedAt", "t0"."RoomId", "t0"."AdultCapacity", "t0"."ChildCapacity", "t0"."CreatedAt", "t0"."DiscountedPrice", "t0"."FeaturedDeal", "t0"."HotelId", "t0"."ImagesUrl", "t0"."PricePerNight", "t0"."RoomType", "t0"."UpdatedAt", "t0"."BookingId", "t0"."CheckInDate", "t0"."CheckOutDate", "t0"."HotelId0", "t0"."RoomId0", "t0"."SpecialRequests", "t0"."TotalPrice", "t0"."UserId", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM (
    SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
    FROM "Hotels" AS "h"
    WHERE "h"."HotelId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId" AS "HotelId0", "b"."RoomId" AS "RoomId0", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
    FROM "Rooms" AS "r"
    LEFT JOIN "Bookings" AS "b" ON "r"."RoomId" = "b"."RoomId"
) AS "t0" ON "t"."HotelId" = "t0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "t"."HotelId" = "g"."HotelId"
ORDER BY "t"."HotelId", "t0"."RoomId", "t0"."BookingId"
2024-07-28 17:00:55.188 -03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."HotelId", "t"."Address", "t"."Amenities", "t"."CityId", "t"."CreatedAt", "t"."Description", "t"."HotelType", "t"."Name", "t"."Owner", "t"."StarRating", "t"."ThumbnailUrl", "t"."UpdatedAt", "t0"."RoomId", "t0"."AdultCapacity", "t0"."ChildCapacity", "t0"."CreatedAt", "t0"."DiscountedPrice", "t0"."FeaturedDeal", "t0"."HotelId", "t0"."ImagesUrl", "t0"."PricePerNight", "t0"."RoomType", "t0"."UpdatedAt", "t0"."BookingId", "t0"."CheckInDate", "t0"."CheckOutDate", "t0"."HotelId0", "t0"."RoomId0", "t0"."SpecialRequests", "t0"."TotalPrice", "t0"."UserId", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM (
    SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
    FROM "Hotels" AS "h"
    WHERE "h"."HotelId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId" AS "HotelId0", "b"."RoomId" AS "RoomId0", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
    FROM "Rooms" AS "r"
    LEFT JOIN "Bookings" AS "b" ON "r"."RoomId" = "b"."RoomId"
) AS "t0" ON "t"."HotelId" = "t0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "t"."HotelId" = "g"."HotelId"
ORDER BY "t"."HotelId", "t0"."RoomId", "t0"."BookingId"
2024-07-28 17:00:55.340 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.BookingController.CreateBooking (HotelBookingSystem.Api) in 6401.1736ms
2024-07-28 17:00:55.347 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.BookingController.CreateBooking (HotelBookingSystem.Api)'
2024-07-28 17:00:57.511 -03:00 [WRN] Invalid operation.
System.InvalidOperationException: Room is already booked for the specified dates
   at HotelBookingSystem.Application.Services.BookingService.CreateBookingAsync(BookingRequest bookingRequest) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Application\Services\BookingService.cs:line 63
   at HotelBookingSystem.Api.Controllers.BookingController.CreateBooking(BookingRequest bookingRequest) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api\Controllers\BookingController.cs:line 29
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at HotelBookingSystem.Api.Middlewares.ErrorHandlingMiddleware.InvokeAsync(HttpContext httpContext) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api\Middlewares\ErrorHandlingMiddleware.cs:line 20
2024-07-28 17:00:57.635 -03:00 [INF] HTTP POST /api/booking responded 400 in 8772.1409 ms
2024-07-28 17:00:57.638 -03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/booking - 400 null application/json 8779.1324ms
2024-07-28 17:01:14.141 -03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/booking - application/json 183
2024-07-28 17:01:14.152 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.BookingController.CreateBooking (HotelBookingSystem.Api)'
2024-07-28 17:01:14.156 -03:00 [INF] Route matched with {action = "CreateBooking", controller = "Booking"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateBooking(HotelBookingSystem.Application.DTO.BookingDTO.BookingRequest) on controller HotelBookingSystem.Api.Controllers.BookingController (HotelBookingSystem.Api).
2024-07-28 17:01:17.004 -03:00 [INF] Executing command: SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-28 17:01:17.007 -03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-28 17:01:17.013 -03:00 [INF] Executing command: SELECT "t"."HotelId", "t"."Address", "t"."Amenities", "t"."CityId", "t"."CreatedAt", "t"."Description", "t"."HotelType", "t"."Name", "t"."Owner", "t"."StarRating", "t"."ThumbnailUrl", "t"."UpdatedAt", "t0"."RoomId", "t0"."AdultCapacity", "t0"."ChildCapacity", "t0"."CreatedAt", "t0"."DiscountedPrice", "t0"."FeaturedDeal", "t0"."HotelId", "t0"."ImagesUrl", "t0"."PricePerNight", "t0"."RoomType", "t0"."UpdatedAt", "t0"."BookingId", "t0"."CheckInDate", "t0"."CheckOutDate", "t0"."HotelId0", "t0"."RoomId0", "t0"."SpecialRequests", "t0"."TotalPrice", "t0"."UserId", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM (
    SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
    FROM "Hotels" AS "h"
    WHERE "h"."HotelId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId" AS "HotelId0", "b"."RoomId" AS "RoomId0", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
    FROM "Rooms" AS "r"
    LEFT JOIN "Bookings" AS "b" ON "r"."RoomId" = "b"."RoomId"
) AS "t0" ON "t"."HotelId" = "t0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "t"."HotelId" = "g"."HotelId"
ORDER BY "t"."HotelId", "t0"."RoomId", "t0"."BookingId"
2024-07-28 17:01:17.018 -03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."HotelId", "t"."Address", "t"."Amenities", "t"."CityId", "t"."CreatedAt", "t"."Description", "t"."HotelType", "t"."Name", "t"."Owner", "t"."StarRating", "t"."ThumbnailUrl", "t"."UpdatedAt", "t0"."RoomId", "t0"."AdultCapacity", "t0"."ChildCapacity", "t0"."CreatedAt", "t0"."DiscountedPrice", "t0"."FeaturedDeal", "t0"."HotelId", "t0"."ImagesUrl", "t0"."PricePerNight", "t0"."RoomType", "t0"."UpdatedAt", "t0"."BookingId", "t0"."CheckInDate", "t0"."CheckOutDate", "t0"."HotelId0", "t0"."RoomId0", "t0"."SpecialRequests", "t0"."TotalPrice", "t0"."UserId", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM (
    SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
    FROM "Hotels" AS "h"
    WHERE "h"."HotelId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId" AS "HotelId0", "b"."RoomId" AS "RoomId0", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
    FROM "Rooms" AS "r"
    LEFT JOIN "Bookings" AS "b" ON "r"."RoomId" = "b"."RoomId"
) AS "t0" ON "t"."HotelId" = "t0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "t"."HotelId" = "g"."HotelId"
ORDER BY "t"."HotelId", "t0"."RoomId", "t0"."BookingId"
2024-07-28 17:01:17.098 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.BookingController.CreateBooking (HotelBookingSystem.Api) in 2937.7103ms
2024-07-28 17:01:17.104 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.BookingController.CreateBooking (HotelBookingSystem.Api)'
2024-07-28 17:01:18.004 -03:00 [WRN] Invalid operation.
System.InvalidOperationException: Room is already booked for the specified dates
   at HotelBookingSystem.Application.Services.BookingService.CreateBookingAsync(BookingRequest bookingRequest) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Application\Services\BookingService.cs:line 63
   at HotelBookingSystem.Api.Controllers.BookingController.CreateBooking(BookingRequest bookingRequest) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api\Controllers\BookingController.cs:line 29
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at HotelBookingSystem.Api.Middlewares.ErrorHandlingMiddleware.InvokeAsync(HttpContext httpContext) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api\Middlewares\ErrorHandlingMiddleware.cs:line 20
2024-07-28 17:01:18.045 -03:00 [INF] HTTP POST /api/booking responded 400 in 3899.9966 ms
2024-07-28 17:01:18.047 -03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/booking - 400 null application/json 3906.1512ms
2024-07-28 17:01:26.395 -03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/booking - application/json 183
2024-07-28 17:01:26.401 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.BookingController.CreateBooking (HotelBookingSystem.Api)'
2024-07-28 17:01:26.403 -03:00 [INF] Route matched with {action = "CreateBooking", controller = "Booking"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateBooking(HotelBookingSystem.Application.DTO.BookingDTO.BookingRequest) on controller HotelBookingSystem.Api.Controllers.BookingController (HotelBookingSystem.Api).
2024-07-28 17:01:27.683 -03:00 [INF] Executing command: SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-28 17:01:27.687 -03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-28 17:01:27.694 -03:00 [INF] Executing command: SELECT "t"."HotelId", "t"."Address", "t"."Amenities", "t"."CityId", "t"."CreatedAt", "t"."Description", "t"."HotelType", "t"."Name", "t"."Owner", "t"."StarRating", "t"."ThumbnailUrl", "t"."UpdatedAt", "t0"."RoomId", "t0"."AdultCapacity", "t0"."ChildCapacity", "t0"."CreatedAt", "t0"."DiscountedPrice", "t0"."FeaturedDeal", "t0"."HotelId", "t0"."ImagesUrl", "t0"."PricePerNight", "t0"."RoomType", "t0"."UpdatedAt", "t0"."BookingId", "t0"."CheckInDate", "t0"."CheckOutDate", "t0"."HotelId0", "t0"."RoomId0", "t0"."SpecialRequests", "t0"."TotalPrice", "t0"."UserId", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM (
    SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
    FROM "Hotels" AS "h"
    WHERE "h"."HotelId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId" AS "HotelId0", "b"."RoomId" AS "RoomId0", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
    FROM "Rooms" AS "r"
    LEFT JOIN "Bookings" AS "b" ON "r"."RoomId" = "b"."RoomId"
) AS "t0" ON "t"."HotelId" = "t0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "t"."HotelId" = "g"."HotelId"
ORDER BY "t"."HotelId", "t0"."RoomId", "t0"."BookingId"
2024-07-28 17:01:27.700 -03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."HotelId", "t"."Address", "t"."Amenities", "t"."CityId", "t"."CreatedAt", "t"."Description", "t"."HotelType", "t"."Name", "t"."Owner", "t"."StarRating", "t"."ThumbnailUrl", "t"."UpdatedAt", "t0"."RoomId", "t0"."AdultCapacity", "t0"."ChildCapacity", "t0"."CreatedAt", "t0"."DiscountedPrice", "t0"."FeaturedDeal", "t0"."HotelId", "t0"."ImagesUrl", "t0"."PricePerNight", "t0"."RoomType", "t0"."UpdatedAt", "t0"."BookingId", "t0"."CheckInDate", "t0"."CheckOutDate", "t0"."HotelId0", "t0"."RoomId0", "t0"."SpecialRequests", "t0"."TotalPrice", "t0"."UserId", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM (
    SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
    FROM "Hotels" AS "h"
    WHERE "h"."HotelId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId" AS "HotelId0", "b"."RoomId" AS "RoomId0", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
    FROM "Rooms" AS "r"
    LEFT JOIN "Bookings" AS "b" ON "r"."RoomId" = "b"."RoomId"
) AS "t0" ON "t"."HotelId" = "t0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "t"."HotelId" = "g"."HotelId"
ORDER BY "t"."HotelId", "t0"."RoomId", "t0"."BookingId"
2024-07-28 17:01:27.769 -03:00 [INF] Executing command: SELECT "u"."UserId", "u"."Address", "u"."City", "u"."Country", "u"."DateOfBirth", "u"."Email", "u"."FirstName", "u"."LastName", "u"."PasswordHash", "u"."PhoneNumber", "u"."Role"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__p_0
LIMIT 1
2024-07-28 17:01:27.772 -03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."Address", "u"."City", "u"."Country", "u"."DateOfBirth", "u"."Email", "u"."FirstName", "u"."LastName", "u"."PasswordHash", "u"."PhoneNumber", "u"."Role"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__p_0
LIMIT 1
2024-07-28 17:01:28.077 -03:00 [INF] Executing command: INSERT INTO "Bookings" ("CheckInDate", "CheckOutDate", "HotelId", "RoomId", "SpecialRequests", "TotalPrice", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6)
RETURNING "BookingId";

2024-07-28 17:01:28.084 -03:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = DateTime), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (Size = 23), @p5='?' (DbType = Decimal), @p6='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Bookings" ("CheckInDate", "CheckOutDate", "HotelId", "RoomId", "SpecialRequests", "TotalPrice", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6)
RETURNING "BookingId";
2024-07-28 17:01:28.165 -03:00 [INF] Executing command: SELECT "t"."CityId", "t"."Country", "t"."CreatedAt", "t"."Name", "t"."PostOffice", "t"."ThumbnailUrl", "t"."UpdatedAt", "t"."Visitors", "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
FROM (
    SELECT "c"."CityId", "c"."Country", "c"."CreatedAt", "c"."Name", "c"."PostOffice", "c"."ThumbnailUrl", "c"."UpdatedAt", "c"."Visitors"
    FROM "Cities" AS "c"
    WHERE "c"."CityId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Hotels" AS "h" ON "t"."CityId" = "h"."CityId"
ORDER BY "t"."CityId"
2024-07-28 17:01:28.169 -03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."CityId", "t"."Country", "t"."CreatedAt", "t"."Name", "t"."PostOffice", "t"."ThumbnailUrl", "t"."UpdatedAt", "t"."Visitors", "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
FROM (
    SELECT "c"."CityId", "c"."Country", "c"."CreatedAt", "c"."Name", "c"."PostOffice", "c"."ThumbnailUrl", "c"."UpdatedAt", "c"."Visitors"
    FROM "Cities" AS "c"
    WHERE "c"."CityId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Hotels" AS "h" ON "t"."CityId" = "h"."CityId"
ORDER BY "t"."CityId"
2024-07-28 17:01:28.225 -03:00 [INF] Executing command: UPDATE "Cities" SET "Country" = @p0, "CreatedAt" = @p1, "Name" = @p2, "PostOffice" = @p3, "ThumbnailUrl" = @p4, "UpdatedAt" = @p5, "Visitors" = @p6
WHERE "CityId" = @p7
RETURNING 1;

2024-07-28 17:01:28.229 -03:00 [INF] Executed DbCommand (4ms) [Parameters=[@p7='?' (DbType = Int32), @p0='?' (Size = 3), @p1='?' (DbType = DateTime), @p2='?' (Size = 6), @p3='?' (Size = 5), @p4='?', @p5='?' (DbType = DateTime), @p6='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Cities" SET "Country" = @p0, "CreatedAt" = @p1, "Name" = @p2, "PostOffice" = @p3, "ThumbnailUrl" = @p4, "UpdatedAt" = @p5, "Visitors" = @p6
WHERE "CityId" = @p7
RETURNING 1;
2024-07-28 17:01:28.351 -03:00 [INF] Executing CreatedAtActionResult, writing value of type 'HotelBookingSystem.Application.DTO.BookingDTO.BookingResponse'.
2024-07-28 17:01:28.407 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.BookingController.CreateBooking (HotelBookingSystem.Api) in 2000.6746ms
2024-07-28 17:01:28.410 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.BookingController.CreateBooking (HotelBookingSystem.Api)'
2024-07-28 17:01:29.589 -03:00 [INF] HTTP POST /api/booking responded 201 in 3191.3231 ms
2024-07-28 17:01:29.591 -03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/booking - 201 null application/json; charset=utf-8 3196.1226ms
2024-07-28 17:02:05.171 -03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/city/4 - application/json 81
2024-07-28 17:02:05.186 -03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 03:40:18', Current time (UTC): '28/7/2024 20:02:05'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2024-07-28 17:02:05.197 -03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 03:40:18', Current time (UTC): '28/7/2024 20:02:05'.
2024-07-28 17:02:05.199 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.CityController.GetCityById (HotelBookingSystem.Api)'
2024-07-28 17:02:05.213 -03:00 [INF] Route matched with {action = "GetCityById", controller = "City"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCityById(Int32) on controller HotelBookingSystem.Api.Controllers.CityController (HotelBookingSystem.Api).
2024-07-28 17:02:05.229 -03:00 [INF] Executing command: SELECT "t"."CityId", "t"."Country", "t"."CreatedAt", "t"."Name", "t"."PostOffice", "t"."ThumbnailUrl", "t"."UpdatedAt", "t"."Visitors", "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
FROM (
    SELECT "c"."CityId", "c"."Country", "c"."CreatedAt", "c"."Name", "c"."PostOffice", "c"."ThumbnailUrl", "c"."UpdatedAt", "c"."Visitors"
    FROM "Cities" AS "c"
    WHERE "c"."CityId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Hotels" AS "h" ON "t"."CityId" = "h"."CityId"
ORDER BY "t"."CityId"
2024-07-28 17:02:05.235 -03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."CityId", "t"."Country", "t"."CreatedAt", "t"."Name", "t"."PostOffice", "t"."ThumbnailUrl", "t"."UpdatedAt", "t"."Visitors", "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
FROM (
    SELECT "c"."CityId", "c"."Country", "c"."CreatedAt", "c"."Name", "c"."PostOffice", "c"."ThumbnailUrl", "c"."UpdatedAt", "c"."Visitors"
    FROM "Cities" AS "c"
    WHERE "c"."CityId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Hotels" AS "h" ON "t"."CityId" = "h"."CityId"
ORDER BY "t"."CityId"
2024-07-28 17:02:05.251 -03:00 [INF] Executing OkObjectResult, writing value of type 'HotelBookingSystem.Application.DTO.CityDTO.CityResponse'.
2024-07-28 17:02:05.258 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.CityController.GetCityById (HotelBookingSystem.Api) in 39.0103ms
2024-07-28 17:02:05.269 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.CityController.GetCityById (HotelBookingSystem.Api)'
2024-07-28 17:02:05.271 -03:00 [INF] HTTP GET /api/city/4 responded 200 in 90.8948 ms
2024-07-28 17:02:05.273 -03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/city/4 - 200 null application/json; charset=utf-8 102.4592ms
2024-07-28 17:02:40.730 -03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/hotel/10 - application/json 251
2024-07-28 17:02:40.738 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.HotelController.GetHotelById (HotelBookingSystem.Api)'
2024-07-28 17:02:40.748 -03:00 [INF] Route matched with {action = "GetHotelById", controller = "Hotel"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetHotelById(Int32) on controller HotelBookingSystem.Api.Controllers.HotelController (HotelBookingSystem.Api).
2024-07-28 17:02:40.760 -03:00 [INF] Executing command: SELECT "t"."HotelId", "t"."Address", "t"."Amenities", "t"."CityId", "t"."CreatedAt", "t"."Description", "t"."HotelType", "t"."Name", "t"."Owner", "t"."StarRating", "t"."ThumbnailUrl", "t"."UpdatedAt", "t0"."RoomId", "t0"."AdultCapacity", "t0"."ChildCapacity", "t0"."CreatedAt", "t0"."DiscountedPrice", "t0"."FeaturedDeal", "t0"."HotelId", "t0"."ImagesUrl", "t0"."PricePerNight", "t0"."RoomType", "t0"."UpdatedAt", "t0"."BookingId", "t0"."CheckInDate", "t0"."CheckOutDate", "t0"."HotelId0", "t0"."RoomId0", "t0"."SpecialRequests", "t0"."TotalPrice", "t0"."UserId", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM (
    SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
    FROM "Hotels" AS "h"
    WHERE "h"."HotelId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId" AS "HotelId0", "b"."RoomId" AS "RoomId0", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
    FROM "Rooms" AS "r"
    LEFT JOIN "Bookings" AS "b" ON "r"."RoomId" = "b"."RoomId"
) AS "t0" ON "t"."HotelId" = "t0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "t"."HotelId" = "g"."HotelId"
ORDER BY "t"."HotelId", "t0"."RoomId", "t0"."BookingId"
2024-07-28 17:02:40.771 -03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."HotelId", "t"."Address", "t"."Amenities", "t"."CityId", "t"."CreatedAt", "t"."Description", "t"."HotelType", "t"."Name", "t"."Owner", "t"."StarRating", "t"."ThumbnailUrl", "t"."UpdatedAt", "t0"."RoomId", "t0"."AdultCapacity", "t0"."ChildCapacity", "t0"."CreatedAt", "t0"."DiscountedPrice", "t0"."FeaturedDeal", "t0"."HotelId", "t0"."ImagesUrl", "t0"."PricePerNight", "t0"."RoomType", "t0"."UpdatedAt", "t0"."BookingId", "t0"."CheckInDate", "t0"."CheckOutDate", "t0"."HotelId0", "t0"."RoomId0", "t0"."SpecialRequests", "t0"."TotalPrice", "t0"."UserId", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM (
    SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
    FROM "Hotels" AS "h"
    WHERE "h"."HotelId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId" AS "HotelId0", "b"."RoomId" AS "RoomId0", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
    FROM "Rooms" AS "r"
    LEFT JOIN "Bookings" AS "b" ON "r"."RoomId" = "b"."RoomId"
) AS "t0" ON "t"."HotelId" = "t0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "t"."HotelId" = "g"."HotelId"
ORDER BY "t"."HotelId", "t0"."RoomId", "t0"."BookingId"
2024-07-28 17:02:40.807 -03:00 [INF] Executing OkObjectResult, writing value of type 'HotelBookingSystem.Application.DTO.HotelDTO.HotelResponse'.
2024-07-28 17:02:40.828 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.HotelController.GetHotelById (HotelBookingSystem.Api) in 76.3225ms
2024-07-28 17:02:40.832 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.HotelController.GetHotelById (HotelBookingSystem.Api)'
2024-07-28 17:02:40.835 -03:00 [INF] HTTP GET /api/hotel/10 responded 200 in 97.8324 ms
2024-07-28 17:02:40.839 -03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/hotel/10 - 200 null application/json; charset=utf-8 144.2863ms
2024-07-28 17:02:52.158 -03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/city/6 - application/json 81
2024-07-28 17:02:52.161 -03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 03:40:18', Current time (UTC): '28/7/2024 20:02:52'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2024-07-28 17:02:52.169 -03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 03:40:18', Current time (UTC): '28/7/2024 20:02:52'.
2024-07-28 17:02:52.170 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.CityController.GetCityById (HotelBookingSystem.Api)'
2024-07-28 17:02:52.172 -03:00 [INF] Route matched with {action = "GetCityById", controller = "City"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCityById(Int32) on controller HotelBookingSystem.Api.Controllers.CityController (HotelBookingSystem.Api).
2024-07-28 17:02:52.178 -03:00 [INF] Executing command: SELECT "t"."CityId", "t"."Country", "t"."CreatedAt", "t"."Name", "t"."PostOffice", "t"."ThumbnailUrl", "t"."UpdatedAt", "t"."Visitors", "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
FROM (
    SELECT "c"."CityId", "c"."Country", "c"."CreatedAt", "c"."Name", "c"."PostOffice", "c"."ThumbnailUrl", "c"."UpdatedAt", "c"."Visitors"
    FROM "Cities" AS "c"
    WHERE "c"."CityId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Hotels" AS "h" ON "t"."CityId" = "h"."CityId"
ORDER BY "t"."CityId"
2024-07-28 17:02:52.186 -03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."CityId", "t"."Country", "t"."CreatedAt", "t"."Name", "t"."PostOffice", "t"."ThumbnailUrl", "t"."UpdatedAt", "t"."Visitors", "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
FROM (
    SELECT "c"."CityId", "c"."Country", "c"."CreatedAt", "c"."Name", "c"."PostOffice", "c"."ThumbnailUrl", "c"."UpdatedAt", "c"."Visitors"
    FROM "Cities" AS "c"
    WHERE "c"."CityId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Hotels" AS "h" ON "t"."CityId" = "h"."CityId"
ORDER BY "t"."CityId"
2024-07-28 17:02:52.193 -03:00 [INF] Executing OkObjectResult, writing value of type 'HotelBookingSystem.Application.DTO.CityDTO.CityResponse'.
2024-07-28 17:02:52.195 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.CityController.GetCityById (HotelBookingSystem.Api) in 19.0806ms
2024-07-28 17:02:52.202 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.CityController.GetCityById (HotelBookingSystem.Api)'
2024-07-28 17:02:52.204 -03:00 [INF] HTTP GET /api/city/6 responded 200 in 43.3004 ms
2024-07-28 17:02:52.205 -03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/city/6 - 200 null application/json; charset=utf-8 47.5146ms
2024-07-28 20:30:41.110 -03:00 [INF] User profile is available. Using 'C:\Users\loren\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-07-28 20:30:41.632 -03:00 [INF] Now listening on: https://localhost:7288
2024-07-28 20:30:41.633 -03:00 [INF] Now listening on: http://localhost:5124
2024-07-28 20:30:41.636 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-07-28 20:30:41.637 -03:00 [INF] Hosting environment: Development
2024-07-28 20:30:41.637 -03:00 [INF] Content root path: C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api
2024-07-28 20:30:43.114 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2024-07-28 20:30:43.670 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 571.3364ms
2024-07-28 20:30:43.718 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2024-07-28 20:30:43.727 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2024-07-28 20:30:43.731 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 13780 application/javascript; charset=utf-8 13.7103ms
2024-07-28 20:30:43.844 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 116.4598ms
2024-07-28 20:30:43.984 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2024-07-28 20:30:44.291 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 307.3085ms
2024-07-28 20:31:56.766 -03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/room/15 - application/json 281
2024-07-28 20:31:57.001 -03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 18:52:08', Current time (UTC): '28/7/2024 23:31:56'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2024-07-28 20:31:57.094 -03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 18:52:08', Current time (UTC): '28/7/2024 23:31:56'.
2024-07-28 20:31:57.101 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api)'
2024-07-28 20:31:57.169 -03:00 [INF] Route matched with {action = "GetRoomById", controller = "Room"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetRoomById(Int32) on controller HotelBookingSystem.Api.Controllers.RoomController (HotelBookingSystem.Api).
2024-07-28 20:31:59.573 -03:00 [INF] Executing command: SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-28 20:31:59.620 -03:00 [INF] Executed DbCommand (36ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-28 20:31:59.780 -03:00 [INF] Executing OkObjectResult, writing value of type 'HotelBookingSystem.Application.DTO.RoomDTO.RoomResponse'.
2024-07-28 20:31:59.817 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api) in 2636.3666ms
2024-07-28 20:31:59.818 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api)'
2024-07-28 20:31:59.821 -03:00 [INF] HTTP GET /api/room/15 responded 200 in 3045.5807 ms
2024-07-28 20:31:59.832 -03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/room/15 - 200 null application/json; charset=utf-8 3066.6967ms
2024-07-28 20:32:09.799 -03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/auth/login - application/json 72
2024-07-28 20:32:09.807 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.AuthController.Login (HotelBookingSystem.Api)'
2024-07-28 20:32:09.817 -03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(HotelBookingSystem.Application.DTO.UserDTO.UserLoginRequest) on controller HotelBookingSystem.Api.Controllers.AuthController (HotelBookingSystem.Api).
2024-07-28 20:32:09.936 -03:00 [INF] Executing command: SELECT "u"."UserId", "u"."Address", "u"."City", "u"."Country", "u"."DateOfBirth", "u"."Email", "u"."FirstName", "u"."LastName", "u"."PasswordHash", "u"."PhoneNumber", "u"."Role"
FROM "Users" AS "u"
WHERE "u"."Email" = @__email_0
LIMIT 1
2024-07-28 20:32:09.942 -03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__email_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."Address", "u"."City", "u"."Country", "u"."DateOfBirth", "u"."Email", "u"."FirstName", "u"."LastName", "u"."PasswordHash", "u"."PhoneNumber", "u"."Role"
FROM "Users" AS "u"
WHERE "u"."Email" = @__email_0
LIMIT 1
2024-07-28 20:32:09.988 -03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-07-28 20:32:09.994 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.AuthController.Login (HotelBookingSystem.Api) in 173.4247ms
2024-07-28 20:32:09.996 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.AuthController.Login (HotelBookingSystem.Api)'
2024-07-28 20:32:09.997 -03:00 [INF] HTTP POST /api/auth/login responded 200 in 192.9925 ms
2024-07-28 20:32:09.998 -03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/auth/login - 200 null application/json; charset=utf-8 199.5403ms
2024-07-28 20:32:56.220 -03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/booking - application/json 182
2024-07-28 20:32:56.276 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.BookingController.CreateBooking (HotelBookingSystem.Api)'
2024-07-28 20:32:56.284 -03:00 [INF] Route matched with {action = "CreateBooking", controller = "Booking"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateBooking(HotelBookingSystem.Application.DTO.BookingDTO.BookingRequest) on controller HotelBookingSystem.Api.Controllers.BookingController (HotelBookingSystem.Api).
2024-07-28 20:33:24.162 -03:00 [INF] Executing command: SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-28 20:33:24.193 -03:00 [INF] Executed DbCommand (31ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-28 20:33:24.232 -03:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2024-07-28 20:33:24.238 -03:00 [INF] Executing command: SELECT "t"."HotelId", "t"."Address", "t"."Amenities", "t"."CityId", "t"."CreatedAt", "t"."Description", "t"."HotelType", "t"."Name", "t"."Owner", "t"."StarRating", "t"."ThumbnailUrl", "t"."UpdatedAt", "t0"."RoomId", "t0"."AdultCapacity", "t0"."ChildCapacity", "t0"."CreatedAt", "t0"."DiscountedPrice", "t0"."FeaturedDeal", "t0"."HotelId", "t0"."ImagesUrl", "t0"."PricePerNight", "t0"."RoomType", "t0"."UpdatedAt", "t0"."BookingId", "t0"."CheckInDate", "t0"."CheckOutDate", "t0"."HotelId0", "t0"."RoomId0", "t0"."SpecialRequests", "t0"."TotalPrice", "t0"."UserId", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM (
    SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
    FROM "Hotels" AS "h"
    WHERE "h"."HotelId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId" AS "HotelId0", "b"."RoomId" AS "RoomId0", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
    FROM "Rooms" AS "r"
    LEFT JOIN "Bookings" AS "b" ON "r"."RoomId" = "b"."RoomId"
) AS "t0" ON "t"."HotelId" = "t0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "t"."HotelId" = "g"."HotelId"
ORDER BY "t"."HotelId", "t0"."RoomId", "t0"."BookingId"
2024-07-28 20:33:24.242 -03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."HotelId", "t"."Address", "t"."Amenities", "t"."CityId", "t"."CreatedAt", "t"."Description", "t"."HotelType", "t"."Name", "t"."Owner", "t"."StarRating", "t"."ThumbnailUrl", "t"."UpdatedAt", "t0"."RoomId", "t0"."AdultCapacity", "t0"."ChildCapacity", "t0"."CreatedAt", "t0"."DiscountedPrice", "t0"."FeaturedDeal", "t0"."HotelId", "t0"."ImagesUrl", "t0"."PricePerNight", "t0"."RoomType", "t0"."UpdatedAt", "t0"."BookingId", "t0"."CheckInDate", "t0"."CheckOutDate", "t0"."HotelId0", "t0"."RoomId0", "t0"."SpecialRequests", "t0"."TotalPrice", "t0"."UserId", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM (
    SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
    FROM "Hotels" AS "h"
    WHERE "h"."HotelId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId" AS "HotelId0", "b"."RoomId" AS "RoomId0", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
    FROM "Rooms" AS "r"
    LEFT JOIN "Bookings" AS "b" ON "r"."RoomId" = "b"."RoomId"
) AS "t0" ON "t"."HotelId" = "t0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "t"."HotelId" = "g"."HotelId"
ORDER BY "t"."HotelId", "t0"."RoomId", "t0"."BookingId"
2024-07-28 20:33:24.339 -03:00 [INF] Executing command: SELECT "u"."UserId", "u"."Address", "u"."City", "u"."Country", "u"."DateOfBirth", "u"."Email", "u"."FirstName", "u"."LastName", "u"."PasswordHash", "u"."PhoneNumber", "u"."Role"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__p_0
LIMIT 1
2024-07-28 20:33:24.340 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."Address", "u"."City", "u"."Country", "u"."DateOfBirth", "u"."Email", "u"."FirstName", "u"."LastName", "u"."PasswordHash", "u"."PhoneNumber", "u"."Role"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__p_0
LIMIT 1
2024-07-28 20:33:24.574 -03:00 [INF] Executing command: INSERT INTO "Bookings" ("CheckInDate", "CheckOutDate", "HotelId", "RoomId", "SpecialRequests", "TotalPrice", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6)
RETURNING "BookingId";

2024-07-28 20:33:24.579 -03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = DateTime), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (Size = 23), @p5='?' (DbType = Decimal), @p6='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Bookings" ("CheckInDate", "CheckOutDate", "HotelId", "RoomId", "SpecialRequests", "TotalPrice", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6)
RETURNING "BookingId";
2024-07-28 20:33:24.737 -03:00 [INF] Executing command: SELECT "t"."CityId", "t"."Country", "t"."CreatedAt", "t"."Name", "t"."PostOffice", "t"."ThumbnailUrl", "t"."UpdatedAt", "t"."Visitors", "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
FROM (
    SELECT "c"."CityId", "c"."Country", "c"."CreatedAt", "c"."Name", "c"."PostOffice", "c"."ThumbnailUrl", "c"."UpdatedAt", "c"."Visitors"
    FROM "Cities" AS "c"
    WHERE "c"."CityId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Hotels" AS "h" ON "t"."CityId" = "h"."CityId"
ORDER BY "t"."CityId"
2024-07-28 20:33:24.739 -03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."CityId", "t"."Country", "t"."CreatedAt", "t"."Name", "t"."PostOffice", "t"."ThumbnailUrl", "t"."UpdatedAt", "t"."Visitors", "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
FROM (
    SELECT "c"."CityId", "c"."Country", "c"."CreatedAt", "c"."Name", "c"."PostOffice", "c"."ThumbnailUrl", "c"."UpdatedAt", "c"."Visitors"
    FROM "Cities" AS "c"
    WHERE "c"."CityId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Hotels" AS "h" ON "t"."CityId" = "h"."CityId"
ORDER BY "t"."CityId"
2024-07-28 20:33:24.774 -03:00 [INF] Executing command: UPDATE "Cities" SET "Country" = @p0, "CreatedAt" = @p1, "Name" = @p2, "PostOffice" = @p3, "ThumbnailUrl" = @p4, "UpdatedAt" = @p5, "Visitors" = @p6
WHERE "CityId" = @p7
RETURNING 1;

2024-07-28 20:33:24.776 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p7='?' (DbType = Int32), @p0='?' (Size = 3), @p1='?' (DbType = DateTime), @p2='?' (Size = 8), @p3='?' (Size = 5), @p4='?', @p5='?' (DbType = DateTime), @p6='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Cities" SET "Country" = @p0, "CreatedAt" = @p1, "Name" = @p2, "PostOffice" = @p3, "ThumbnailUrl" = @p4, "UpdatedAt" = @p5, "Visitors" = @p6
WHERE "CityId" = @p7
RETURNING 1;
2024-07-28 20:33:29.831 -03:00 [INF] Executing CreatedAtActionResult, writing value of type 'HotelBookingSystem.Application.DTO.BookingDTO.BookingResponse'.
2024-07-28 20:33:29.916 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.BookingController.CreateBooking (HotelBookingSystem.Api) in 33630.1095ms
2024-07-28 20:33:29.919 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.BookingController.CreateBooking (HotelBookingSystem.Api)'
2024-07-28 20:33:43.054 -03:00 [INF] Email sent successfully to john.doe@example.com
2024-07-28 20:33:43.058 -03:00 [INF] HTTP POST /api/booking responded 201 in 46807.1513 ms
2024-07-28 20:33:43.061 -03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/booking - 201 null application/json; charset=utf-8 46846.0122ms
2024-07-28 20:34:27.891 -03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/auth/login - application/json 74
2024-07-28 20:34:27.900 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.AuthController.Login (HotelBookingSystem.Api)'
2024-07-28 20:34:27.901 -03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(HotelBookingSystem.Application.DTO.UserDTO.UserLoginRequest) on controller HotelBookingSystem.Api.Controllers.AuthController (HotelBookingSystem.Api).
2024-07-28 20:34:27.907 -03:00 [INF] Executing command: SELECT "u"."UserId", "u"."Address", "u"."City", "u"."Country", "u"."DateOfBirth", "u"."Email", "u"."FirstName", "u"."LastName", "u"."PasswordHash", "u"."PhoneNumber", "u"."Role"
FROM "Users" AS "u"
WHERE "u"."Email" = @__email_0
LIMIT 1
2024-07-28 20:34:27.909 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__email_0='?' (Size = 22)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."Address", "u"."City", "u"."Country", "u"."DateOfBirth", "u"."Email", "u"."FirstName", "u"."LastName", "u"."PasswordHash", "u"."PhoneNumber", "u"."Role"
FROM "Users" AS "u"
WHERE "u"."Email" = @__email_0
LIMIT 1
2024-07-28 20:34:27.912 -03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-07-28 20:34:27.914 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.AuthController.Login (HotelBookingSystem.Api) in 9.774ms
2024-07-28 20:34:27.915 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.AuthController.Login (HotelBookingSystem.Api)'
2024-07-28 20:34:27.916 -03:00 [INF] HTTP POST /api/auth/login responded 200 in 16.1293 ms
2024-07-28 20:34:27.918 -03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/auth/login - 200 null application/json; charset=utf-8 28.032ms
2024-07-28 20:34:44.639 -03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/booking - application/json 182
2024-07-28 20:34:44.643 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.BookingController.CreateBooking (HotelBookingSystem.Api)'
2024-07-28 20:34:44.644 -03:00 [INF] Route matched with {action = "CreateBooking", controller = "Booking"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateBooking(HotelBookingSystem.Application.DTO.BookingDTO.BookingRequest) on controller HotelBookingSystem.Api.Controllers.BookingController (HotelBookingSystem.Api).
2024-07-28 20:34:53.419 -03:00 [INF] Executing command: SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-28 20:34:53.425 -03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-28 20:34:53.429 -03:00 [INF] Executing command: SELECT "t"."HotelId", "t"."Address", "t"."Amenities", "t"."CityId", "t"."CreatedAt", "t"."Description", "t"."HotelType", "t"."Name", "t"."Owner", "t"."StarRating", "t"."ThumbnailUrl", "t"."UpdatedAt", "t0"."RoomId", "t0"."AdultCapacity", "t0"."ChildCapacity", "t0"."CreatedAt", "t0"."DiscountedPrice", "t0"."FeaturedDeal", "t0"."HotelId", "t0"."ImagesUrl", "t0"."PricePerNight", "t0"."RoomType", "t0"."UpdatedAt", "t0"."BookingId", "t0"."CheckInDate", "t0"."CheckOutDate", "t0"."HotelId0", "t0"."RoomId0", "t0"."SpecialRequests", "t0"."TotalPrice", "t0"."UserId", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM (
    SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
    FROM "Hotels" AS "h"
    WHERE "h"."HotelId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId" AS "HotelId0", "b"."RoomId" AS "RoomId0", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
    FROM "Rooms" AS "r"
    LEFT JOIN "Bookings" AS "b" ON "r"."RoomId" = "b"."RoomId"
) AS "t0" ON "t"."HotelId" = "t0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "t"."HotelId" = "g"."HotelId"
ORDER BY "t"."HotelId", "t0"."RoomId", "t0"."BookingId"
2024-07-28 20:34:53.431 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."HotelId", "t"."Address", "t"."Amenities", "t"."CityId", "t"."CreatedAt", "t"."Description", "t"."HotelType", "t"."Name", "t"."Owner", "t"."StarRating", "t"."ThumbnailUrl", "t"."UpdatedAt", "t0"."RoomId", "t0"."AdultCapacity", "t0"."ChildCapacity", "t0"."CreatedAt", "t0"."DiscountedPrice", "t0"."FeaturedDeal", "t0"."HotelId", "t0"."ImagesUrl", "t0"."PricePerNight", "t0"."RoomType", "t0"."UpdatedAt", "t0"."BookingId", "t0"."CheckInDate", "t0"."CheckOutDate", "t0"."HotelId0", "t0"."RoomId0", "t0"."SpecialRequests", "t0"."TotalPrice", "t0"."UserId", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM (
    SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
    FROM "Hotels" AS "h"
    WHERE "h"."HotelId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId" AS "HotelId0", "b"."RoomId" AS "RoomId0", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
    FROM "Rooms" AS "r"
    LEFT JOIN "Bookings" AS "b" ON "r"."RoomId" = "b"."RoomId"
) AS "t0" ON "t"."HotelId" = "t0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "t"."HotelId" = "g"."HotelId"
ORDER BY "t"."HotelId", "t0"."RoomId", "t0"."BookingId"
2024-07-28 20:34:55.453 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.BookingController.CreateBooking (HotelBookingSystem.Api) in 10806.6849ms
2024-07-28 20:34:55.460 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.BookingController.CreateBooking (HotelBookingSystem.Api)'
2024-07-28 20:35:00.453 -03:00 [WRN] Invalid operation.
System.InvalidOperationException: Room is already booked for the specified dates
   at HotelBookingSystem.Application.Services.BookingService.CreateBookingAsync(BookingRequest bookingRequest) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Application\Services\BookingService.cs:line 63
   at HotelBookingSystem.Api.Controllers.BookingController.CreateBooking(BookingRequest bookingRequest) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api\Controllers\BookingController.cs:line 29
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at HotelBookingSystem.Api.Middlewares.ErrorHandlingMiddleware.InvokeAsync(HttpContext httpContext) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api\Middlewares\ErrorHandlingMiddleware.cs:line 20
2024-07-28 20:35:08.091 -03:00 [INF] HTTP POST /api/booking responded 400 in 23449.2520 ms
2024-07-28 20:35:08.093 -03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/booking - 400 null application/json 23453.7117ms
2024-07-28 20:35:36.127 -03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/booking - application/json 182
2024-07-28 20:35:36.133 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.BookingController.CreateBooking (HotelBookingSystem.Api)'
2024-07-28 20:35:36.134 -03:00 [INF] Route matched with {action = "CreateBooking", controller = "Booking"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateBooking(HotelBookingSystem.Application.DTO.BookingDTO.BookingRequest) on controller HotelBookingSystem.Api.Controllers.BookingController (HotelBookingSystem.Api).
2024-07-28 20:35:36.158 -03:00 [INF] Executing command: SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-28 20:35:36.161 -03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-28 20:35:36.166 -03:00 [INF] Executing command: SELECT "t"."HotelId", "t"."Address", "t"."Amenities", "t"."CityId", "t"."CreatedAt", "t"."Description", "t"."HotelType", "t"."Name", "t"."Owner", "t"."StarRating", "t"."ThumbnailUrl", "t"."UpdatedAt", "t0"."RoomId", "t0"."AdultCapacity", "t0"."ChildCapacity", "t0"."CreatedAt", "t0"."DiscountedPrice", "t0"."FeaturedDeal", "t0"."HotelId", "t0"."ImagesUrl", "t0"."PricePerNight", "t0"."RoomType", "t0"."UpdatedAt", "t0"."BookingId", "t0"."CheckInDate", "t0"."CheckOutDate", "t0"."HotelId0", "t0"."RoomId0", "t0"."SpecialRequests", "t0"."TotalPrice", "t0"."UserId", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM (
    SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
    FROM "Hotels" AS "h"
    WHERE "h"."HotelId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId" AS "HotelId0", "b"."RoomId" AS "RoomId0", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
    FROM "Rooms" AS "r"
    LEFT JOIN "Bookings" AS "b" ON "r"."RoomId" = "b"."RoomId"
) AS "t0" ON "t"."HotelId" = "t0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "t"."HotelId" = "g"."HotelId"
ORDER BY "t"."HotelId", "t0"."RoomId", "t0"."BookingId"
2024-07-28 20:35:36.170 -03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."HotelId", "t"."Address", "t"."Amenities", "t"."CityId", "t"."CreatedAt", "t"."Description", "t"."HotelType", "t"."Name", "t"."Owner", "t"."StarRating", "t"."ThumbnailUrl", "t"."UpdatedAt", "t0"."RoomId", "t0"."AdultCapacity", "t0"."ChildCapacity", "t0"."CreatedAt", "t0"."DiscountedPrice", "t0"."FeaturedDeal", "t0"."HotelId", "t0"."ImagesUrl", "t0"."PricePerNight", "t0"."RoomType", "t0"."UpdatedAt", "t0"."BookingId", "t0"."CheckInDate", "t0"."CheckOutDate", "t0"."HotelId0", "t0"."RoomId0", "t0"."SpecialRequests", "t0"."TotalPrice", "t0"."UserId", "g"."GuestReviewId", "g"."Comment", "g"."CreatedDate", "g"."HotelId", "g"."Rating", "g"."UserId"
FROM (
    SELECT "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
    FROM "Hotels" AS "h"
    WHERE "h"."HotelId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId" AS "HotelId0", "b"."RoomId" AS "RoomId0", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
    FROM "Rooms" AS "r"
    LEFT JOIN "Bookings" AS "b" ON "r"."RoomId" = "b"."RoomId"
) AS "t0" ON "t"."HotelId" = "t0"."HotelId"
LEFT JOIN "GuestReviews" AS "g" ON "t"."HotelId" = "g"."HotelId"
ORDER BY "t"."HotelId", "t0"."RoomId", "t0"."BookingId"
2024-07-28 20:35:36.178 -03:00 [INF] Executing command: SELECT "u"."UserId", "u"."Address", "u"."City", "u"."Country", "u"."DateOfBirth", "u"."Email", "u"."FirstName", "u"."LastName", "u"."PasswordHash", "u"."PhoneNumber", "u"."Role"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__p_0
LIMIT 1
2024-07-28 20:35:36.179 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."Address", "u"."City", "u"."Country", "u"."DateOfBirth", "u"."Email", "u"."FirstName", "u"."LastName", "u"."PasswordHash", "u"."PhoneNumber", "u"."Role"
FROM "Users" AS "u"
WHERE "u"."UserId" = @__p_0
LIMIT 1
2024-07-28 20:35:36.184 -03:00 [INF] Executing command: INSERT INTO "Bookings" ("CheckInDate", "CheckOutDate", "HotelId", "RoomId", "SpecialRequests", "TotalPrice", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6)
RETURNING "BookingId";

2024-07-28 20:35:36.185 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = DateTime), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (Size = 23), @p5='?' (DbType = Decimal), @p6='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Bookings" ("CheckInDate", "CheckOutDate", "HotelId", "RoomId", "SpecialRequests", "TotalPrice", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6)
RETURNING "BookingId";
2024-07-28 20:35:36.196 -03:00 [INF] Executing command: SELECT "t"."CityId", "t"."Country", "t"."CreatedAt", "t"."Name", "t"."PostOffice", "t"."ThumbnailUrl", "t"."UpdatedAt", "t"."Visitors", "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
FROM (
    SELECT "c"."CityId", "c"."Country", "c"."CreatedAt", "c"."Name", "c"."PostOffice", "c"."ThumbnailUrl", "c"."UpdatedAt", "c"."Visitors"
    FROM "Cities" AS "c"
    WHERE "c"."CityId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Hotels" AS "h" ON "t"."CityId" = "h"."CityId"
ORDER BY "t"."CityId"
2024-07-28 20:35:36.198 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."CityId", "t"."Country", "t"."CreatedAt", "t"."Name", "t"."PostOffice", "t"."ThumbnailUrl", "t"."UpdatedAt", "t"."Visitors", "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt"
FROM (
    SELECT "c"."CityId", "c"."Country", "c"."CreatedAt", "c"."Name", "c"."PostOffice", "c"."ThumbnailUrl", "c"."UpdatedAt", "c"."Visitors"
    FROM "Cities" AS "c"
    WHERE "c"."CityId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Hotels" AS "h" ON "t"."CityId" = "h"."CityId"
ORDER BY "t"."CityId"
2024-07-28 20:35:36.201 -03:00 [INF] Executing command: UPDATE "Cities" SET "Country" = @p0, "CreatedAt" = @p1, "Name" = @p2, "PostOffice" = @p3, "ThumbnailUrl" = @p4, "UpdatedAt" = @p5, "Visitors" = @p6
WHERE "CityId" = @p7
RETURNING 1;

2024-07-28 20:35:36.202 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[@p7='?' (DbType = Int32), @p0='?' (Size = 3), @p1='?' (DbType = DateTime), @p2='?' (Size = 8), @p3='?' (Size = 5), @p4='?', @p5='?' (DbType = DateTime), @p6='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Cities" SET "Country" = @p0, "CreatedAt" = @p1, "Name" = @p2, "PostOffice" = @p3, "ThumbnailUrl" = @p4, "UpdatedAt" = @p5, "Visitors" = @p6
WHERE "CityId" = @p7
RETURNING 1;
2024-07-28 20:35:36.208 -03:00 [INF] Executing CreatedAtActionResult, writing value of type 'HotelBookingSystem.Application.DTO.BookingDTO.BookingResponse'.
2024-07-28 20:35:36.219 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.BookingController.CreateBooking (HotelBookingSystem.Api) in 82.1625ms
2024-07-28 20:35:36.224 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.BookingController.CreateBooking (HotelBookingSystem.Api)'
2024-07-28 20:35:36.225 -03:00 [INF] HTTP POST /api/booking responded 201 in 94.4291 ms
2024-07-28 20:35:36.227 -03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/booking - 201 null application/json; charset=utf-8 128.1852ms
2024-07-28 20:35:36.258 -03:00 [INF] Email sent successfully to lorena.tuhay@gmail.com
