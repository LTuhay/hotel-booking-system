2024-07-30 00:00:52.419 -03:00 [INF] User profile is available. Using 'C:\Users\loren\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-07-30 00:00:52.820 -03:00 [INF] Now listening on: https://localhost:7288
2024-07-30 00:00:52.823 -03:00 [INF] Now listening on: http://localhost:5124
2024-07-30 00:00:52.828 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-07-30 00:00:52.830 -03:00 [INF] Hosting environment: Development
2024-07-30 00:00:52.831 -03:00 [INF] Content root path: C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api
2024-07-30 00:00:53.855 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2024-07-30 00:00:54.559 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 709.056ms
2024-07-30 00:00:54.616 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2024-07-30 00:00:54.617 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2024-07-30 00:00:54.635 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 13780 application/javascript; charset=utf-8 19.1774ms
2024-07-30 00:00:54.768 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 151.4728ms
2024-07-30 00:00:54.923 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2024-07-30 00:00:55.355 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 432.6883ms
2024-07-30 00:01:04.159 -03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7288/api/booking/15 - null null
2024-07-30 00:01:04.395 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.BookingController.CancelBooking (HotelBookingSystem.Api)'
2024-07-30 00:01:04.439 -03:00 [INF] Route matched with {action = "CancelBooking", controller = "Booking"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CancelBooking(Int32) on controller HotelBookingSystem.Api.Controllers.BookingController (HotelBookingSystem.Api).
2024-07-30 00:01:07.098 -03:00 [INF] Executing command: SELECT "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId", "p"."PaymentId", "p"."Amount", "p"."BookingId", "p"."PaymentDate", "p"."PaymentMethod", "p"."Status", "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt", "u"."UserId", "u"."Address", "u"."City", "u"."Country", "u"."DateOfBirth", "u"."Email", "u"."FirstName", "u"."LastName", "u"."PasswordHash", "u"."PhoneNumber", "u"."Role", "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
FROM "Bookings" AS "b"
LEFT JOIN "Payments" AS "p" ON "b"."BookingId" = "p"."BookingId"
INNER JOIN "Hotels" AS "h" ON "b"."HotelId" = "h"."HotelId"
INNER JOIN "Users" AS "u" ON "b"."UserId" = "u"."UserId"
INNER JOIN "Rooms" AS "r" ON "b"."RoomId" = "r"."RoomId"
WHERE "b"."BookingId" = @__bookingId_0
LIMIT 1
2024-07-30 00:01:07.148 -03:00 [INF] Executed DbCommand (42ms) [Parameters=[@__bookingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId", "p"."PaymentId", "p"."Amount", "p"."BookingId", "p"."PaymentDate", "p"."PaymentMethod", "p"."Status", "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt", "u"."UserId", "u"."Address", "u"."City", "u"."Country", "u"."DateOfBirth", "u"."Email", "u"."FirstName", "u"."LastName", "u"."PasswordHash", "u"."PhoneNumber", "u"."Role", "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
FROM "Bookings" AS "b"
LEFT JOIN "Payments" AS "p" ON "b"."BookingId" = "p"."BookingId"
INNER JOIN "Hotels" AS "h" ON "b"."HotelId" = "h"."HotelId"
INNER JOIN "Users" AS "u" ON "b"."UserId" = "u"."UserId"
INNER JOIN "Rooms" AS "r" ON "b"."RoomId" = "r"."RoomId"
WHERE "b"."BookingId" = @__bookingId_0
LIMIT 1
2024-07-30 00:01:07.721 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.BookingController.CancelBooking (HotelBookingSystem.Api) in 3272.2403ms
2024-07-30 00:01:07.725 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.BookingController.CancelBooking (HotelBookingSystem.Api)'
2024-07-30 00:01:07.760 -03:00 [WRN] Invalid operation.
System.InvalidOperationException: Cannot delete booking with an associated payment.
   at HotelBookingSystem.Application.Services.BookingService.CancelBookingAsync(Int32 bookingId) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Application\Services\BookingService.cs:line 127
   at HotelBookingSystem.Api.Controllers.BookingController.CancelBooking(Int32 bookingId) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api\Controllers\BookingController.cs:line 39
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at HotelBookingSystem.Api.Middlewares.ErrorHandlingMiddleware.InvokeAsync(HttpContext httpContext) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api\Middlewares\ErrorHandlingMiddleware.cs:line 20
2024-07-30 00:01:07.852 -03:00 [INF] HTTP DELETE /api/booking/15 responded 400 in 3677.1857 ms
2024-07-30 00:01:07.860 -03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7288/api/booking/15 - 400 null application/json 3701.2253ms
2024-07-30 23:18:05.798 -03:00 [INF] User profile is available. Using 'C:\Users\loren\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-07-30 23:18:06.036 -03:00 [INF] Now listening on: https://localhost:7288
2024-07-30 23:18:06.037 -03:00 [INF] Now listening on: http://localhost:5124
2024-07-30 23:18:06.039 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-07-30 23:18:06.040 -03:00 [INF] Hosting environment: Development
2024-07-30 23:18:06.040 -03:00 [INF] Content root path: C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api
2024-07-30 23:18:08.798 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2024-07-30 23:18:09.323 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 538.8693ms
2024-07-30 23:18:09.332 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2024-07-30 23:18:09.349 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 13780 application/javascript; charset=utf-8 16.8758ms
2024-07-30 23:18:09.363 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2024-07-30 23:18:09.634 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 270.9031ms
2024-07-30 23:18:10.549 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2024-07-30 23:18:10.872 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 323.5874ms
2024-07-30 23:19:26.932 -03:00 [INF] Request starting HTTP/1.1 POST https://localhost:7288/api/auth/login - application/json 72
2024-07-30 23:19:27.593 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.AuthController.Login (HotelBookingSystem.Api)'
2024-07-30 23:19:27.692 -03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(HotelBookingSystem.Application.DTO.UserDTO.UserLoginRequest) on controller HotelBookingSystem.Api.Controllers.AuthController (HotelBookingSystem.Api).
2024-07-30 23:19:31.561 -03:00 [INF] Executing command: SELECT "u"."UserId", "u"."Address", "u"."City", "u"."Country", "u"."DateOfBirth", "u"."Email", "u"."FirstName", "u"."LastName", "u"."PasswordHash", "u"."PhoneNumber", "u"."Role"
FROM "Users" AS "u"
WHERE "u"."Email" = @__email_0
LIMIT 1
2024-07-30 23:19:31.636 -03:00 [INF] Executed DbCommand (70ms) [Parameters=[@__email_0='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SELECT "u"."UserId", "u"."Address", "u"."City", "u"."Country", "u"."DateOfBirth", "u"."Email", "u"."FirstName", "u"."LastName", "u"."PasswordHash", "u"."PhoneNumber", "u"."Role"
FROM "Users" AS "u"
WHERE "u"."Email" = @__email_0
LIMIT 1
2024-07-30 23:19:31.913 -03:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-07-30 23:19:31.934 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.AuthController.Login (HotelBookingSystem.Api) in 4229.271ms
2024-07-30 23:19:31.936 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.AuthController.Login (HotelBookingSystem.Api)'
2024-07-30 23:19:31.942 -03:00 [INF] HTTP POST /api/auth/login responded 200 in 4988.2927 ms
2024-07-30 23:19:31.964 -03:00 [INF] Request finished HTTP/1.1 POST https://localhost:7288/api/auth/login - 200 null application/json; charset=utf-8 5032.9954ms
2024-07-30 23:19:58.991 -03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/booking/15 - null null
2024-07-30 23:20:00.718 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.BookingController.GetBookingDetails (HotelBookingSystem.Api)'
2024-07-30 23:20:01.034 -03:00 [INF] Route matched with {action = "GetBookingDetails", controller = "Booking"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetBookingDetails(Int32) on controller HotelBookingSystem.Api.Controllers.BookingController (HotelBookingSystem.Api).
2024-07-30 23:20:09.844 -03:00 [INF] Executing command: SELECT "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId", "p"."PaymentId", "p"."Amount", "p"."BookingId", "p"."PaymentDate", "p"."PaymentMethod", "p"."Status", "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt", "u"."UserId", "u"."Address", "u"."City", "u"."Country", "u"."DateOfBirth", "u"."Email", "u"."FirstName", "u"."LastName", "u"."PasswordHash", "u"."PhoneNumber", "u"."Role", "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
FROM "Bookings" AS "b"
LEFT JOIN "Payments" AS "p" ON "b"."BookingId" = "p"."BookingId"
INNER JOIN "Hotels" AS "h" ON "b"."HotelId" = "h"."HotelId"
INNER JOIN "Users" AS "u" ON "b"."UserId" = "u"."UserId"
INNER JOIN "Rooms" AS "r" ON "b"."RoomId" = "r"."RoomId"
WHERE "b"."BookingId" = @__bookingId_0
LIMIT 1
2024-07-30 23:20:09.870 -03:00 [INF] Executed DbCommand (26ms) [Parameters=[@__bookingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId", "p"."PaymentId", "p"."Amount", "p"."BookingId", "p"."PaymentDate", "p"."PaymentMethod", "p"."Status", "h"."HotelId", "h"."Address", "h"."Amenities", "h"."CityId", "h"."CreatedAt", "h"."Description", "h"."HotelType", "h"."Name", "h"."Owner", "h"."StarRating", "h"."ThumbnailUrl", "h"."UpdatedAt", "u"."UserId", "u"."Address", "u"."City", "u"."Country", "u"."DateOfBirth", "u"."Email", "u"."FirstName", "u"."LastName", "u"."PasswordHash", "u"."PhoneNumber", "u"."Role", "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
FROM "Bookings" AS "b"
LEFT JOIN "Payments" AS "p" ON "b"."BookingId" = "p"."BookingId"
INNER JOIN "Hotels" AS "h" ON "b"."HotelId" = "h"."HotelId"
INNER JOIN "Users" AS "u" ON "b"."UserId" = "u"."UserId"
INNER JOIN "Rooms" AS "r" ON "b"."RoomId" = "r"."RoomId"
WHERE "b"."BookingId" = @__bookingId_0
LIMIT 1
2024-07-30 23:20:10.210 -03:00 [INF] Executing OkObjectResult, writing value of type 'HotelBookingSystem.Application.DTO.BookingDTO.BookingResponse'.
2024-07-30 23:20:10.245 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.BookingController.GetBookingDetails (HotelBookingSystem.Api) in 9201.1249ms
2024-07-30 23:20:10.253 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.BookingController.GetBookingDetails (HotelBookingSystem.Api)'
2024-07-30 23:20:10.257 -03:00 [INF] HTTP GET /api/booking/15 responded 200 in 11261.8158 ms
2024-07-30 23:20:10.261 -03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/booking/15 - 200 null application/json; charset=utf-8 11269.5586ms
2024-07-30 23:20:57.839 -03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/room/search?CheckInDate=2024-12-01&CheckOutDate=2024-12-07 - null null
2024-07-30 23:20:57.861 -03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 20:34:40', Current time (UTC): '31/7/2024 02:20:57'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2024-07-30 23:20:57.936 -03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 20:34:40', Current time (UTC): '31/7/2024 02:20:57'.
2024-07-30 23:20:57.938 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.RoomController.SearchRooms (HotelBookingSystem.Api)'
2024-07-30 23:20:57.949 -03:00 [INF] Route matched with {action = "SearchRooms", controller = "Room"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SearchRooms(HotelBookingSystem.Application.DTO.RoomDTO.RoomSearchParameters) on controller HotelBookingSystem.Api.Controllers.RoomController (HotelBookingSystem.Api).
2024-07-30 23:20:58.163 -03:00 [INF] Executing command: SELECT COUNT(*)
FROM "Rooms" AS "r"
WHERE NOT EXISTS (
    SELECT 1
    FROM "Bookings" AS "b"
    WHERE "r"."RoomId" = "b"."RoomId" AND "b"."CheckOutDate" > @__searchParameters_CheckInDate_0 AND "b"."CheckInDate" < @__searchParameters_CheckOutDate_1) AND "r"."AdultCapacity" >= @__searchParameters_Adults_2 AND "r"."ChildCapacity" >= @__searchParameters_Children_3
2024-07-30 23:20:58.168 -03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__searchParameters_CheckInDate_0='?' (DbType = DateTime), @__searchParameters_CheckOutDate_1='?' (DbType = DateTime), @__searchParameters_Adults_2='?' (DbType = Int32), @__searchParameters_Children_3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Rooms" AS "r"
WHERE NOT EXISTS (
    SELECT 1
    FROM "Bookings" AS "b"
    WHERE "r"."RoomId" = "b"."RoomId" AND "b"."CheckOutDate" > @__searchParameters_CheckInDate_0 AND "b"."CheckInDate" < @__searchParameters_CheckOutDate_1) AND "r"."AdultCapacity" >= @__searchParameters_Adults_2 AND "r"."ChildCapacity" >= @__searchParameters_Children_3
2024-07-30 23:20:58.189 -03:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2024-07-30 23:20:58.193 -03:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2024-07-30 23:20:58.224 -03:00 [INF] Executing command: SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b0"."BookingId", "b0"."CheckInDate", "b0"."CheckOutDate", "b0"."HotelId", "b0"."RoomId", "b0"."SpecialRequests", "b0"."TotalPrice", "b0"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE NOT EXISTS (
        SELECT 1
        FROM "Bookings" AS "b"
        WHERE "r"."RoomId" = "b"."RoomId" AND "b"."CheckOutDate" > @__searchParameters_CheckInDate_0 AND "b"."CheckInDate" < @__searchParameters_CheckOutDate_1) AND "r"."AdultCapacity" >= @__searchParameters_Adults_2 AND "r"."ChildCapacity" >= @__searchParameters_Children_3
    LIMIT @__p_5 OFFSET @__p_4
) AS "t"
LEFT JOIN "Bookings" AS "b0" ON "t"."RoomId" = "b0"."RoomId"
ORDER BY "t"."RoomId"
2024-07-30 23:20:58.231 -03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__searchParameters_CheckInDate_0='?' (DbType = DateTime), @__searchParameters_CheckOutDate_1='?' (DbType = DateTime), @__searchParameters_Adults_2='?' (DbType = Int32), @__searchParameters_Children_3='?' (DbType = Int32), @__p_5='?' (DbType = Int32), @__p_4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b0"."BookingId", "b0"."CheckInDate", "b0"."CheckOutDate", "b0"."HotelId", "b0"."RoomId", "b0"."SpecialRequests", "b0"."TotalPrice", "b0"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE NOT EXISTS (
        SELECT 1
        FROM "Bookings" AS "b"
        WHERE "r"."RoomId" = "b"."RoomId" AND "b"."CheckOutDate" > @__searchParameters_CheckInDate_0 AND "b"."CheckInDate" < @__searchParameters_CheckOutDate_1) AND "r"."AdultCapacity" >= @__searchParameters_Adults_2 AND "r"."ChildCapacity" >= @__searchParameters_Children_3
    LIMIT @__p_5 OFFSET @__p_4
) AS "t"
LEFT JOIN "Bookings" AS "b0" ON "t"."RoomId" = "b0"."RoomId"
ORDER BY "t"."RoomId"
2024-07-30 23:20:58.270 -03:00 [INF] Executing OkObjectResult, writing value of type 'HotelBookingSystem.Domain.Utilities.PaginatedList`1[[HotelBookingSystem.Application.DTO.RoomDTO.RoomResponse, HotelBookingSystem.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-07-30 23:20:58.298 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.RoomController.SearchRooms (HotelBookingSystem.Api) in 344.3022ms
2024-07-30 23:20:58.301 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.RoomController.SearchRooms (HotelBookingSystem.Api)'
2024-07-30 23:20:58.302 -03:00 [INF] HTTP GET /api/room/search responded 200 in 458.5242 ms
2024-07-30 23:20:58.304 -03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/room/search?CheckInDate=2024-12-01&CheckOutDate=2024-12-07 - 200 null application/json; charset=utf-8 465.7129ms
2024-07-30 23:27:08.525 -03:00 [INF] User profile is available. Using 'C:\Users\loren\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-07-30 23:27:09.037 -03:00 [INF] Now listening on: https://localhost:7288
2024-07-30 23:27:09.039 -03:00 [INF] Now listening on: http://localhost:5124
2024-07-30 23:27:09.041 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-07-30 23:27:09.043 -03:00 [INF] Hosting environment: Development
2024-07-30 23:27:09.044 -03:00 [INF] Content root path: C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api
2024-07-30 23:27:10.409 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2024-07-30 23:27:10.790 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 384.49ms
2024-07-30 23:27:10.834 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2024-07-30 23:27:10.834 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2024-07-30 23:27:10.865 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 13780 application/javascript; charset=utf-8 30.6546ms
2024-07-30 23:27:10.919 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 85.3156ms
2024-07-30 23:27:11.173 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2024-07-30 23:27:11.374 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 201.9231ms
2024-07-30 23:27:21.598 -03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/room/search?CheckInDate=2024-12-01&CheckOutDate=2024-12-07 - null null
2024-07-30 23:27:21.822 -03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 20:34:40', Current time (UTC): '31/7/2024 02:27:21'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2024-07-30 23:27:21.906 -03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 20:34:40', Current time (UTC): '31/7/2024 02:27:21'.
2024-07-30 23:27:21.925 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.RoomController.SearchRooms (HotelBookingSystem.Api)'
2024-07-30 23:27:22.003 -03:00 [INF] Route matched with {action = "SearchRooms", controller = "Room"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SearchRooms(HotelBookingSystem.Application.DTO.RoomDTO.RoomSearchParameters) on controller HotelBookingSystem.Api.Controllers.RoomController (HotelBookingSystem.Api).
2024-07-30 23:27:24.526 -03:00 [INF] Executing command: SELECT COUNT(*)
FROM "Rooms" AS "r"
WHERE NOT EXISTS (
    SELECT 1
    FROM "Bookings" AS "b"
    WHERE "r"."RoomId" = "b"."RoomId" AND "b"."CheckInDate" < @__searchParameters_CheckOutDate_0 AND "b"."CheckOutDate" > @__searchParameters_CheckInDate_1) AND "r"."AdultCapacity" >= @__searchParameters_Adults_2 AND "r"."ChildCapacity" >= @__searchParameters_Children_3
2024-07-30 23:27:24.584 -03:00 [INF] Executed DbCommand (44ms) [Parameters=[@__searchParameters_CheckOutDate_0='?' (DbType = DateTime), @__searchParameters_CheckInDate_1='?' (DbType = DateTime), @__searchParameters_Adults_2='?' (DbType = Int32), @__searchParameters_Children_3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Rooms" AS "r"
WHERE NOT EXISTS (
    SELECT 1
    FROM "Bookings" AS "b"
    WHERE "r"."RoomId" = "b"."RoomId" AND "b"."CheckInDate" < @__searchParameters_CheckOutDate_0 AND "b"."CheckOutDate" > @__searchParameters_CheckInDate_1) AND "r"."AdultCapacity" >= @__searchParameters_Adults_2 AND "r"."ChildCapacity" >= @__searchParameters_Children_3
2024-07-30 23:27:24.659 -03:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2024-07-30 23:27:24.662 -03:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2024-07-30 23:27:24.758 -03:00 [INF] Executing command: SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b0"."BookingId", "b0"."CheckInDate", "b0"."CheckOutDate", "b0"."HotelId", "b0"."RoomId", "b0"."SpecialRequests", "b0"."TotalPrice", "b0"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE NOT EXISTS (
        SELECT 1
        FROM "Bookings" AS "b"
        WHERE "r"."RoomId" = "b"."RoomId" AND "b"."CheckInDate" < @__searchParameters_CheckOutDate_0 AND "b"."CheckOutDate" > @__searchParameters_CheckInDate_1) AND "r"."AdultCapacity" >= @__searchParameters_Adults_2 AND "r"."ChildCapacity" >= @__searchParameters_Children_3
    LIMIT @__p_5 OFFSET @__p_4
) AS "t"
LEFT JOIN "Bookings" AS "b0" ON "t"."RoomId" = "b0"."RoomId"
ORDER BY "t"."RoomId"
2024-07-30 23:27:24.764 -03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__searchParameters_CheckOutDate_0='?' (DbType = DateTime), @__searchParameters_CheckInDate_1='?' (DbType = DateTime), @__searchParameters_Adults_2='?' (DbType = Int32), @__searchParameters_Children_3='?' (DbType = Int32), @__p_5='?' (DbType = Int32), @__p_4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b0"."BookingId", "b0"."CheckInDate", "b0"."CheckOutDate", "b0"."HotelId", "b0"."RoomId", "b0"."SpecialRequests", "b0"."TotalPrice", "b0"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE NOT EXISTS (
        SELECT 1
        FROM "Bookings" AS "b"
        WHERE "r"."RoomId" = "b"."RoomId" AND "b"."CheckInDate" < @__searchParameters_CheckOutDate_0 AND "b"."CheckOutDate" > @__searchParameters_CheckInDate_1) AND "r"."AdultCapacity" >= @__searchParameters_Adults_2 AND "r"."ChildCapacity" >= @__searchParameters_Children_3
    LIMIT @__p_5 OFFSET @__p_4
) AS "t"
LEFT JOIN "Bookings" AS "b0" ON "t"."RoomId" = "b0"."RoomId"
ORDER BY "t"."RoomId"
2024-07-30 23:27:24.970 -03:00 [INF] Executing OkObjectResult, writing value of type 'HotelBookingSystem.Domain.Utilities.PaginatedList`1[[HotelBookingSystem.Application.DTO.RoomDTO.RoomResponse, HotelBookingSystem.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-07-30 23:27:25.032 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.RoomController.SearchRooms (HotelBookingSystem.Api) in 3016.5564ms
2024-07-30 23:27:25.035 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.RoomController.SearchRooms (HotelBookingSystem.Api)'
2024-07-30 23:27:25.042 -03:00 [INF] HTTP GET /api/room/search responded 200 in 3426.9084 ms
2024-07-30 23:27:25.057 -03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/room/search?CheckInDate=2024-12-01&CheckOutDate=2024-12-07 - 200 null application/json; charset=utf-8 3458.8821ms
2024-07-30 23:28:33.000 -03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/room/search?CheckInDate=2024-12-01&CheckOutDate=2024-12-07&Page=2 - null null
2024-07-30 23:28:33.009 -03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 20:34:40', Current time (UTC): '31/7/2024 02:28:33'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2024-07-30 23:28:33.020 -03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 20:34:40', Current time (UTC): '31/7/2024 02:28:33'.
2024-07-30 23:28:33.024 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.RoomController.SearchRooms (HotelBookingSystem.Api)'
2024-07-30 23:28:33.029 -03:00 [INF] Route matched with {action = "SearchRooms", controller = "Room"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SearchRooms(HotelBookingSystem.Application.DTO.RoomDTO.RoomSearchParameters) on controller HotelBookingSystem.Api.Controllers.RoomController (HotelBookingSystem.Api).
2024-07-30 23:28:33.124 -03:00 [INF] Executing command: SELECT COUNT(*)
FROM "Rooms" AS "r"
WHERE NOT EXISTS (
    SELECT 1
    FROM "Bookings" AS "b"
    WHERE "r"."RoomId" = "b"."RoomId" AND "b"."CheckInDate" < @__searchParameters_CheckOutDate_0 AND "b"."CheckOutDate" > @__searchParameters_CheckInDate_1) AND "r"."AdultCapacity" >= @__searchParameters_Adults_2 AND "r"."ChildCapacity" >= @__searchParameters_Children_3
2024-07-30 23:28:33.129 -03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__searchParameters_CheckOutDate_0='?' (DbType = DateTime), @__searchParameters_CheckInDate_1='?' (DbType = DateTime), @__searchParameters_Adults_2='?' (DbType = Int32), @__searchParameters_Children_3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM "Rooms" AS "r"
WHERE NOT EXISTS (
    SELECT 1
    FROM "Bookings" AS "b"
    WHERE "r"."RoomId" = "b"."RoomId" AND "b"."CheckInDate" < @__searchParameters_CheckOutDate_0 AND "b"."CheckOutDate" > @__searchParameters_CheckInDate_1) AND "r"."AdultCapacity" >= @__searchParameters_Adults_2 AND "r"."ChildCapacity" >= @__searchParameters_Children_3
2024-07-30 23:28:33.137 -03:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2024-07-30 23:28:33.138 -03:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2024-07-30 23:28:33.154 -03:00 [INF] Executing command: SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b0"."BookingId", "b0"."CheckInDate", "b0"."CheckOutDate", "b0"."HotelId", "b0"."RoomId", "b0"."SpecialRequests", "b0"."TotalPrice", "b0"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE NOT EXISTS (
        SELECT 1
        FROM "Bookings" AS "b"
        WHERE "r"."RoomId" = "b"."RoomId" AND "b"."CheckInDate" < @__searchParameters_CheckOutDate_0 AND "b"."CheckOutDate" > @__searchParameters_CheckInDate_1) AND "r"."AdultCapacity" >= @__searchParameters_Adults_2 AND "r"."ChildCapacity" >= @__searchParameters_Children_3
    LIMIT @__p_4 OFFSET @__p_4
) AS "t"
LEFT JOIN "Bookings" AS "b0" ON "t"."RoomId" = "b0"."RoomId"
ORDER BY "t"."RoomId"
2024-07-30 23:28:33.160 -03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__searchParameters_CheckOutDate_0='?' (DbType = DateTime), @__searchParameters_CheckInDate_1='?' (DbType = DateTime), @__searchParameters_Adults_2='?' (DbType = Int32), @__searchParameters_Children_3='?' (DbType = Int32), @__p_4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b0"."BookingId", "b0"."CheckInDate", "b0"."CheckOutDate", "b0"."HotelId", "b0"."RoomId", "b0"."SpecialRequests", "b0"."TotalPrice", "b0"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE NOT EXISTS (
        SELECT 1
        FROM "Bookings" AS "b"
        WHERE "r"."RoomId" = "b"."RoomId" AND "b"."CheckInDate" < @__searchParameters_CheckOutDate_0 AND "b"."CheckOutDate" > @__searchParameters_CheckInDate_1) AND "r"."AdultCapacity" >= @__searchParameters_Adults_2 AND "r"."ChildCapacity" >= @__searchParameters_Children_3
    LIMIT @__p_4 OFFSET @__p_4
) AS "t"
LEFT JOIN "Bookings" AS "b0" ON "t"."RoomId" = "b0"."RoomId"
ORDER BY "t"."RoomId"
2024-07-30 23:28:33.171 -03:00 [INF] Executing OkObjectResult, writing value of type 'HotelBookingSystem.Domain.Utilities.PaginatedList`1[[HotelBookingSystem.Application.DTO.RoomDTO.RoomResponse, HotelBookingSystem.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-07-30 23:28:33.173 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.RoomController.SearchRooms (HotelBookingSystem.Api) in 141.1178ms
2024-07-30 23:28:33.175 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.RoomController.SearchRooms (HotelBookingSystem.Api)'
2024-07-30 23:28:33.181 -03:00 [INF] HTTP GET /api/room/search responded 200 in 174.9008 ms
2024-07-30 23:28:33.183 -03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/room/search?CheckInDate=2024-12-01&CheckOutDate=2024-12-07&Page=2 - 200 null application/json; charset=utf-8 183.5122ms
2024-07-30 23:33:25.661 -03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/room/8/15 - application/json 281
2024-07-30 23:33:25.666 -03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 18:52:08', Current time (UTC): '31/7/2024 02:33:25'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2024-07-30 23:33:25.674 -03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 18:52:08', Current time (UTC): '31/7/2024 02:33:25'.
2024-07-30 23:33:25.675 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api)'
2024-07-30 23:33:25.683 -03:00 [INF] Route matched with {action = "GetRoomById", controller = "Room"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetRoomById(Int32, Int32) on controller HotelBookingSystem.Api.Controllers.RoomController (HotelBookingSystem.Api).
2024-07-30 23:33:25.724 -03:00 [INF] Executing command: SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-30 23:33:25.729 -03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-30 23:33:25.912 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api) in 224.6173ms
2024-07-30 23:33:25.917 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api)'
2024-07-30 23:33:25.939 -03:00 [WRN] Invalid argument.
System.ArgumentException: Invalid hotel ID
   at HotelBookingSystem.Application.Services.RoomService.GetRoomByIdAsync(Int32 hotelId, Int32 roomId) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Application\Services\RoomService.cs:line 73
   at HotelBookingSystem.Api.Controllers.RoomController.GetRoomById(Int32 hotelId, Int32 roomId) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api\Controllers\RoomController.cs:line 30
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at HotelBookingSystem.Api.Middlewares.ErrorHandlingMiddleware.InvokeAsync(HttpContext httpContext) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api\Middlewares\ErrorHandlingMiddleware.cs:line 20
2024-07-30 23:33:25.987 -03:00 [INF] HTTP GET /api/room/8/15 responded 400 in 323.4207 ms
2024-07-30 23:33:25.989 -03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/room/8/15 - 400 null application/json 328.2116ms
2024-07-30 23:33:35.742 -03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/room/7/15 - application/json 281
2024-07-30 23:33:35.744 -03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 18:52:08', Current time (UTC): '31/7/2024 02:33:35'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2024-07-30 23:33:35.755 -03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 18:52:08', Current time (UTC): '31/7/2024 02:33:35'.
2024-07-30 23:33:35.758 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api)'
2024-07-30 23:33:35.759 -03:00 [INF] Route matched with {action = "GetRoomById", controller = "Room"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetRoomById(Int32, Int32) on controller HotelBookingSystem.Api.Controllers.RoomController (HotelBookingSystem.Api).
2024-07-30 23:33:35.763 -03:00 [INF] Executing command: SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-30 23:33:35.766 -03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-30 23:33:35.825 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api) in 63.6259ms
2024-07-30 23:33:35.827 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api)'
2024-07-30 23:33:35.848 -03:00 [WRN] Invalid argument.
System.ArgumentException: Invalid hotel ID
   at HotelBookingSystem.Application.Services.RoomService.GetRoomByIdAsync(Int32 hotelId, Int32 roomId) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Application\Services\RoomService.cs:line 73
   at HotelBookingSystem.Api.Controllers.RoomController.GetRoomById(Int32 hotelId, Int32 roomId) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api\Controllers\RoomController.cs:line 30
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at HotelBookingSystem.Api.Middlewares.ErrorHandlingMiddleware.InvokeAsync(HttpContext httpContext) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api\Middlewares\ErrorHandlingMiddleware.cs:line 20
2024-07-30 23:33:35.870 -03:00 [INF] HTTP GET /api/room/7/15 responded 400 in 126.2624 ms
2024-07-30 23:33:35.872 -03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/room/7/15 - 400 null application/json 129.5637ms
2024-07-30 23:33:39.517 -03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/room/6/15 - application/json 281
2024-07-30 23:33:39.520 -03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 18:52:08', Current time (UTC): '31/7/2024 02:33:39'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2024-07-30 23:33:39.529 -03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 18:52:08', Current time (UTC): '31/7/2024 02:33:39'.
2024-07-30 23:33:39.531 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api)'
2024-07-30 23:33:39.534 -03:00 [INF] Route matched with {action = "GetRoomById", controller = "Room"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetRoomById(Int32, Int32) on controller HotelBookingSystem.Api.Controllers.RoomController (HotelBookingSystem.Api).
2024-07-30 23:33:39.537 -03:00 [INF] Executing command: SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-30 23:33:39.540 -03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-30 23:33:39.554 -03:00 [INF] Executing OkObjectResult, writing value of type 'HotelBookingSystem.Application.DTO.RoomDTO.RoomResponse'.
2024-07-30 23:33:39.556 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api) in 20.1292ms
2024-07-30 23:33:39.564 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api)'
2024-07-30 23:33:39.566 -03:00 [INF] HTTP GET /api/room/6/15 responded 200 in 47.0761 ms
2024-07-30 23:33:39.567 -03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/room/6/15 - 200 null application/json; charset=utf-8 50.9124ms
2024-07-30 23:35:03.445 -03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/room/6/15 - application/json 281
2024-07-30 23:35:03.450 -03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 18:52:08', Current time (UTC): '31/7/2024 02:35:03'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2024-07-30 23:35:03.457 -03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 18:52:08', Current time (UTC): '31/7/2024 02:35:03'.
2024-07-30 23:35:03.458 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api)'
2024-07-30 23:35:03.461 -03:00 [INF] Route matched with {action = "GetRoomById", controller = "Room"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetRoomById(Int32, Int32) on controller HotelBookingSystem.Api.Controllers.RoomController (HotelBookingSystem.Api).
2024-07-30 23:35:03.465 -03:00 [INF] Executing command: SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-30 23:35:03.467 -03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-30 23:35:03.485 -03:00 [ERR] An exception occurred while iterating over the results of a query for context type 'HotelBookingSystem.Infrastructure.Data.ApplicationDbContext'.
System.FormatException: String '1988' was not recognized as a valid DateTime.
   at System.DateTime.Parse(String s, IFormatProvider provider)
   at Microsoft.Data.Sqlite.SqliteValueReader.GetDateTime(Int32 ordinal)
   at Microsoft.Data.Sqlite.SqliteDataReader.GetDateTime(Int32 ordinal)
   at lambda_method179(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.<PopulateIncludeCollection>g__ProcessCurrentElementRow|23_0[TIncludingEntity,TIncludedEntity](<>c__DisplayClass23_0`2&)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.PopulateIncludeCollection[TIncludingEntity,TIncludedEntity](Int32 collectionId, QueryContext queryContext, DbDataReader dbDataReader, SingleQueryResultCoordinator resultCoordinator, Func`3 parentIdentifier, Func`3 outerIdentifier, Func`3 selfIdentifier, IReadOnlyList`1 parentIdentifierValueComparers, IReadOnlyList`1 outerIdentifierValueComparers, IReadOnlyList`1 selfIdentifierValueComparers, Func`5 innerShaper, INavigationBase inverseNavigation, Action`2 fixup, Boolean trackingQuery)
   at lambda_method181(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.FormatException: String '1988' was not recognized as a valid DateTime.
   at System.DateTime.Parse(String s, IFormatProvider provider)
   at Microsoft.Data.Sqlite.SqliteValueReader.GetDateTime(Int32 ordinal)
   at Microsoft.Data.Sqlite.SqliteDataReader.GetDateTime(Int32 ordinal)
   at lambda_method179(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.<PopulateIncludeCollection>g__ProcessCurrentElementRow|23_0[TIncludingEntity,TIncludedEntity](<>c__DisplayClass23_0`2&)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.PopulateIncludeCollection[TIncludingEntity,TIncludedEntity](Int32 collectionId, QueryContext queryContext, DbDataReader dbDataReader, SingleQueryResultCoordinator resultCoordinator, Func`3 parentIdentifier, Func`3 outerIdentifier, Func`3 selfIdentifier, IReadOnlyList`1 parentIdentifierValueComparers, IReadOnlyList`1 outerIdentifierValueComparers, IReadOnlyList`1 selfIdentifierValueComparers, Func`5 innerShaper, INavigationBase inverseNavigation, Action`2 fixup, Boolean trackingQuery)
   at lambda_method181(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2024-07-30 23:35:03.592 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api) in 129.1275ms
2024-07-30 23:35:03.596 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api)'
2024-07-30 23:35:03.620 -03:00 [ERR] An unhandled exception has occurred.
System.FormatException: String '1988' was not recognized as a valid DateTime.
   at System.DateTime.Parse(String s, IFormatProvider provider)
   at Microsoft.Data.Sqlite.SqliteValueReader.GetDateTime(Int32 ordinal)
   at Microsoft.Data.Sqlite.SqliteDataReader.GetDateTime(Int32 ordinal)
   at lambda_method179(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.<PopulateIncludeCollection>g__ProcessCurrentElementRow|23_0[TIncludingEntity,TIncludedEntity](<>c__DisplayClass23_0`2&)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.PopulateIncludeCollection[TIncludingEntity,TIncludedEntity](Int32 collectionId, QueryContext queryContext, DbDataReader dbDataReader, SingleQueryResultCoordinator resultCoordinator, Func`3 parentIdentifier, Func`3 outerIdentifier, Func`3 selfIdentifier, IReadOnlyList`1 parentIdentifierValueComparers, IReadOnlyList`1 outerIdentifierValueComparers, IReadOnlyList`1 selfIdentifierValueComparers, Func`5 innerShaper, INavigationBase inverseNavigation, Action`2 fixup, Boolean trackingQuery)
   at lambda_method181(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at HotelBookingSystem.Infrastructure.Repository.RoomRepository.GetByIdAsync(Int32 id) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Infrastructure\Repository\RoomRepository.cs:line 19
   at HotelBookingSystem.Application.Services.RoomService.GetRoomByIdAsync(Int32 hotelId, Int32 roomId) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Application\Services\RoomService.cs:line 68
   at HotelBookingSystem.Api.Controllers.RoomController.GetRoomById(Int32 hotelId, Int32 roomId) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api\Controllers\RoomController.cs:line 30
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at HotelBookingSystem.Api.Middlewares.ErrorHandlingMiddleware.InvokeAsync(HttpContext httpContext) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api\Middlewares\ErrorHandlingMiddleware.cs:line 20
2024-07-30 23:35:03.665 -03:00 [ERR] HTTP GET /api/room/6/15 responded 500 in 215.3901 ms
2024-07-30 23:35:03.667 -03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/room/6/15 - 500 null application/json 222.463ms
2024-07-30 23:35:28.117 -03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/room/6/15 - application/json 281
2024-07-30 23:35:28.120 -03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 18:52:08', Current time (UTC): '31/7/2024 02:35:28'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2024-07-30 23:35:28.128 -03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 18:52:08', Current time (UTC): '31/7/2024 02:35:28'.
2024-07-30 23:35:28.130 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api)'
2024-07-30 23:35:28.132 -03:00 [INF] Route matched with {action = "GetRoomById", controller = "Room"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetRoomById(Int32, Int32) on controller HotelBookingSystem.Api.Controllers.RoomController (HotelBookingSystem.Api).
2024-07-30 23:35:33.540 -03:00 [INF] Executing command: SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-30 23:35:33.545 -03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-30 23:35:33.550 -03:00 [ERR] An exception occurred while iterating over the results of a query for context type 'HotelBookingSystem.Infrastructure.Data.ApplicationDbContext'.
System.FormatException: String '1988' was not recognized as a valid DateTime.
   at System.DateTime.Parse(String s, IFormatProvider provider)
   at Microsoft.Data.Sqlite.SqliteValueReader.GetDateTime(Int32 ordinal)
   at Microsoft.Data.Sqlite.SqliteDataReader.GetDateTime(Int32 ordinal)
   at lambda_method179(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.<PopulateIncludeCollection>g__ProcessCurrentElementRow|23_0[TIncludingEntity,TIncludedEntity](<>c__DisplayClass23_0`2&)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.PopulateIncludeCollection[TIncludingEntity,TIncludedEntity](Int32 collectionId, QueryContext queryContext, DbDataReader dbDataReader, SingleQueryResultCoordinator resultCoordinator, Func`3 parentIdentifier, Func`3 outerIdentifier, Func`3 selfIdentifier, IReadOnlyList`1 parentIdentifierValueComparers, IReadOnlyList`1 outerIdentifierValueComparers, IReadOnlyList`1 selfIdentifierValueComparers, Func`5 innerShaper, INavigationBase inverseNavigation, Action`2 fixup, Boolean trackingQuery)
   at lambda_method181(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.FormatException: String '1988' was not recognized as a valid DateTime.
   at System.DateTime.Parse(String s, IFormatProvider provider)
   at Microsoft.Data.Sqlite.SqliteValueReader.GetDateTime(Int32 ordinal)
   at Microsoft.Data.Sqlite.SqliteDataReader.GetDateTime(Int32 ordinal)
   at lambda_method179(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.<PopulateIncludeCollection>g__ProcessCurrentElementRow|23_0[TIncludingEntity,TIncludedEntity](<>c__DisplayClass23_0`2&)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.PopulateIncludeCollection[TIncludingEntity,TIncludedEntity](Int32 collectionId, QueryContext queryContext, DbDataReader dbDataReader, SingleQueryResultCoordinator resultCoordinator, Func`3 parentIdentifier, Func`3 outerIdentifier, Func`3 selfIdentifier, IReadOnlyList`1 parentIdentifierValueComparers, IReadOnlyList`1 outerIdentifierValueComparers, IReadOnlyList`1 selfIdentifierValueComparers, Func`5 innerShaper, INavigationBase inverseNavigation, Action`2 fixup, Boolean trackingQuery)
   at lambda_method181(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2024-07-30 23:35:37.286 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api) in 9150.914ms
2024-07-30 23:35:37.290 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api)'
2024-07-30 23:35:40.745 -03:00 [ERR] An unhandled exception has occurred.
System.FormatException: String '1988' was not recognized as a valid DateTime.
   at System.DateTime.Parse(String s, IFormatProvider provider)
   at Microsoft.Data.Sqlite.SqliteValueReader.GetDateTime(Int32 ordinal)
   at Microsoft.Data.Sqlite.SqliteDataReader.GetDateTime(Int32 ordinal)
   at lambda_method179(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.<PopulateIncludeCollection>g__ProcessCurrentElementRow|23_0[TIncludingEntity,TIncludedEntity](<>c__DisplayClass23_0`2&)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.PopulateIncludeCollection[TIncludingEntity,TIncludedEntity](Int32 collectionId, QueryContext queryContext, DbDataReader dbDataReader, SingleQueryResultCoordinator resultCoordinator, Func`3 parentIdentifier, Func`3 outerIdentifier, Func`3 selfIdentifier, IReadOnlyList`1 parentIdentifierValueComparers, IReadOnlyList`1 outerIdentifierValueComparers, IReadOnlyList`1 selfIdentifierValueComparers, Func`5 innerShaper, INavigationBase inverseNavigation, Action`2 fixup, Boolean trackingQuery)
   at lambda_method181(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at HotelBookingSystem.Infrastructure.Repository.RoomRepository.GetByIdAsync(Int32 id) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Infrastructure\Repository\RoomRepository.cs:line 19
   at HotelBookingSystem.Application.Services.RoomService.GetRoomByIdAsync(Int32 hotelId, Int32 roomId) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Application\Services\RoomService.cs:line 68
   at HotelBookingSystem.Api.Controllers.RoomController.GetRoomById(Int32 hotelId, Int32 roomId) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api\Controllers\RoomController.cs:line 30
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at HotelBookingSystem.Api.Middlewares.ErrorHandlingMiddleware.InvokeAsync(HttpContext httpContext) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api\Middlewares\ErrorHandlingMiddleware.cs:line 20
2024-07-30 23:35:45.412 -03:00 [ERR] HTTP GET /api/room/6/15 responded 500 in 17293.3940 ms
2024-07-30 23:35:45.414 -03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/room/6/15 - 500 null application/json 17297.2187ms
2024-07-30 23:35:48.117 -03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/room/6/15 - application/json 281
2024-07-30 23:35:48.120 -03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 18:52:08', Current time (UTC): '31/7/2024 02:35:48'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2024-07-30 23:35:48.127 -03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 18:52:08', Current time (UTC): '31/7/2024 02:35:48'.
2024-07-30 23:35:48.131 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api)'
2024-07-30 23:35:48.134 -03:00 [INF] Route matched with {action = "GetRoomById", controller = "Room"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetRoomById(Int32, Int32) on controller HotelBookingSystem.Api.Controllers.RoomController (HotelBookingSystem.Api).
2024-07-30 23:36:21.012 -03:00 [INF] Executing command: SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-30 23:36:21.022 -03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-30 23:36:21.026 -03:00 [ERR] An exception occurred while iterating over the results of a query for context type 'HotelBookingSystem.Infrastructure.Data.ApplicationDbContext'.
System.FormatException: String '1988' was not recognized as a valid DateTime.
   at Microsoft.Data.Sqlite.SqliteDataReader.GetDateTime(Int32 ordinal)
   at lambda_method179(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.<PopulateIncludeCollection>g__ProcessCurrentElementRow|23_0[TIncludingEntity,TIncludedEntity](<>c__DisplayClass23_0`2&)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.PopulateIncludeCollection[TIncludingEntity,TIncludedEntity](Int32 collectionId, QueryContext queryContext, DbDataReader dbDataReader, SingleQueryResultCoordinator resultCoordinator, Func`3 parentIdentifier, Func`3 outerIdentifier, Func`3 selfIdentifier, IReadOnlyList`1 parentIdentifierValueComparers, IReadOnlyList`1 outerIdentifierValueComparers, IReadOnlyList`1 selfIdentifierValueComparers, Func`5 innerShaper, INavigationBase inverseNavigation, Action`2 fixup, Boolean trackingQuery)
   at lambda_method181(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.FormatException: String '1988' was not recognized as a valid DateTime.
   at Microsoft.Data.Sqlite.SqliteDataReader.GetDateTime(Int32 ordinal)
   at lambda_method179(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.<PopulateIncludeCollection>g__ProcessCurrentElementRow|23_0[TIncludingEntity,TIncludedEntity](<>c__DisplayClass23_0`2&)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.PopulateIncludeCollection[TIncludingEntity,TIncludedEntity](Int32 collectionId, QueryContext queryContext, DbDataReader dbDataReader, SingleQueryResultCoordinator resultCoordinator, Func`3 parentIdentifier, Func`3 outerIdentifier, Func`3 selfIdentifier, IReadOnlyList`1 parentIdentifierValueComparers, IReadOnlyList`1 outerIdentifierValueComparers, IReadOnlyList`1 selfIdentifierValueComparers, Func`5 innerShaper, INavigationBase inverseNavigation, Action`2 fixup, Boolean trackingQuery)
   at lambda_method181(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2024-07-30 23:36:26.810 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api) in 38674.173ms
2024-07-30 23:36:26.815 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api)'
2024-07-30 23:38:00.464 -03:00 [ERR] An unhandled exception has occurred.
System.FormatException: String '1988' was not recognized as a valid DateTime.
   at Microsoft.Data.Sqlite.SqliteDataReader.GetDateTime(Int32 ordinal)
   at lambda_method179(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.<PopulateIncludeCollection>g__ProcessCurrentElementRow|23_0[TIncludingEntity,TIncludedEntity](<>c__DisplayClass23_0`2&)
   at Microsoft.EntityFrameworkCore.Query.RelationalShapedQueryCompilingExpressionVisitor.ShaperProcessingExpressionVisitor.PopulateIncludeCollection[TIncludingEntity,TIncludedEntity](Int32 collectionId, QueryContext queryContext, DbDataReader dbDataReader, SingleQueryResultCoordinator resultCoordinator, Func`3 parentIdentifier, Func`3 outerIdentifier, Func`3 selfIdentifier, IReadOnlyList`1 parentIdentifierValueComparers, IReadOnlyList`1 outerIdentifierValueComparers, IReadOnlyList`1 selfIdentifierValueComparers, Func`5 innerShaper, INavigationBase inverseNavigation, Action`2 fixup, Boolean trackingQuery)
   at lambda_method181(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at HotelBookingSystem.Infrastructure.Repository.RoomRepository.GetByIdAsync(Int32 id) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Infrastructure\Repository\RoomRepository.cs:line 19
   at HotelBookingSystem.Application.Services.RoomService.GetRoomByIdAsync(Int32 hotelId, Int32 roomId) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Application\Services\RoomService.cs:line 68
   at HotelBookingSystem.Api.Controllers.RoomController.GetRoomById(Int32 hotelId, Int32 roomId) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api\Controllers\RoomController.cs:line 30
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at HotelBookingSystem.Api.Middlewares.ErrorHandlingMiddleware.InvokeAsync(HttpContext httpContext) in C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api\Middlewares\ErrorHandlingMiddleware.cs:line 20
2024-07-30 23:38:02.070 -03:00 [ERR] HTTP GET /api/room/6/15 responded 500 in 133951.1295 ms
2024-07-30 23:38:02.072 -03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/room/6/15 - 500 null application/json 133954.4945ms
2024-07-30 23:38:05.017 -03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/room/6/15 - application/json 281
2024-07-30 23:38:05.021 -03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 18:52:08', Current time (UTC): '31/7/2024 02:38:05'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2024-07-30 23:38:05.029 -03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 18:52:08', Current time (UTC): '31/7/2024 02:38:05'.
2024-07-30 23:38:05.031 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api)'
2024-07-30 23:38:05.032 -03:00 [INF] Route matched with {action = "GetRoomById", controller = "Room"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetRoomById(Int32, Int32) on controller HotelBookingSystem.Api.Controllers.RoomController (HotelBookingSystem.Api).
2024-07-30 23:38:07.994 -03:00 [INF] Executing command: SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-30 23:38:08.001 -03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-30 23:38:08.961 -03:00 [INF] Executing OkObjectResult, writing value of type 'HotelBookingSystem.Application.DTO.RoomDTO.RoomResponse'.
2024-07-30 23:38:08.963 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api) in 3929.0202ms
2024-07-30 23:38:08.964 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api)'
2024-07-30 23:38:10.262 -03:00 [INF] HTTP GET /api/room/6/15 responded 200 in 5241.7841 ms
2024-07-30 23:38:10.263 -03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/room/6/15 - 200 null application/json; charset=utf-8 5246.4771ms
2024-07-30 23:45:49.227 -03:00 [INF] User profile is available. Using 'C:\Users\loren\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-07-30 23:45:49.531 -03:00 [INF] Now listening on: https://localhost:7288
2024-07-30 23:45:49.532 -03:00 [INF] Now listening on: http://localhost:5124
2024-07-30 23:45:49.535 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2024-07-30 23:45:49.536 -03:00 [INF] Hosting environment: Development
2024-07-30 23:45:49.536 -03:00 [INF] Content root path: C:\Users\loren\source\repos\Hotel Booking System\HotelBookingSystem.Api
2024-07-30 23:45:50.379 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/index.html - null null
2024-07-30 23:45:50.619 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/index.html - 200 null text/html;charset=utf-8 244.3989ms
2024-07-30 23:45:50.631 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - null null
2024-07-30 23:45:50.643 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_framework/aspnetcore-browser-refresh.js - 200 13780 application/javascript; charset=utf-8 12.685ms
2024-07-30 23:45:50.648 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/_vs/browserLink - null null
2024-07-30 23:45:50.707 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/_vs/browserLink - 200 null text/javascript; charset=UTF-8 59.5686ms
2024-07-30 23:45:50.790 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - null null
2024-07-30 23:45:50.969 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7288/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 179.161ms
2024-07-30 23:45:55.023 -03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/room/6/15 - application/json 281
2024-07-30 23:45:55.264 -03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 18:52:08', Current time (UTC): '31/7/2024 02:45:55'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2024-07-30 23:45:55.327 -03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 18:52:08', Current time (UTC): '31/7/2024 02:45:55'.
2024-07-30 23:45:55.339 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api)'
2024-07-30 23:45:55.392 -03:00 [INF] Route matched with {action = "GetRoomById", controller = "Room"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetRoomById(Int32, Int32) on controller HotelBookingSystem.Api.Controllers.RoomController (HotelBookingSystem.Api).
2024-07-30 23:46:04.507 -03:00 [INF] Executing command: SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-30 23:46:04.536 -03:00 [INF] Executed DbCommand (24ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-30 23:47:03.455 -03:00 [INF] Executing OkObjectResult, writing value of type 'HotelBookingSystem.Application.DTO.RoomDTO.RoomResponse'.
2024-07-30 23:47:03.504 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api) in 68102.6658ms
2024-07-30 23:47:03.508 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api)'
2024-07-30 23:47:04.388 -03:00 [INF] HTTP GET /api/room/6/15 responded 200 in 69351.0246 ms
2024-07-30 23:47:04.401 -03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/room/6/15 - 200 null application/json; charset=utf-8 69377.8977ms
2024-07-30 23:47:30.946 -03:00 [INF] Request starting HTTP/1.1 GET https://localhost:7288/api/room/6/15 - application/json 281
2024-07-30 23:47:30.959 -03:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 18:52:08', Current time (UTC): '31/7/2024 02:47:30'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2024-07-30 23:47:30.966 -03:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '25/7/2024 18:52:08', Current time (UTC): '31/7/2024 02:47:30'.
2024-07-30 23:47:30.967 -03:00 [INF] Executing endpoint 'HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api)'
2024-07-30 23:47:30.969 -03:00 [INF] Route matched with {action = "GetRoomById", controller = "Room"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetRoomById(Int32, Int32) on controller HotelBookingSystem.Api.Controllers.RoomController (HotelBookingSystem.Api).
2024-07-30 23:47:31.066 -03:00 [INF] Executing command: SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-30 23:47:31.073 -03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT "t"."RoomId", "t"."AdultCapacity", "t"."ChildCapacity", "t"."CreatedAt", "t"."DiscountedPrice", "t"."FeaturedDeal", "t"."HotelId", "t"."ImagesUrl", "t"."PricePerNight", "t"."RoomType", "t"."UpdatedAt", "b"."BookingId", "b"."CheckInDate", "b"."CheckOutDate", "b"."HotelId", "b"."RoomId", "b"."SpecialRequests", "b"."TotalPrice", "b"."UserId"
FROM (
    SELECT "r"."RoomId", "r"."AdultCapacity", "r"."ChildCapacity", "r"."CreatedAt", "r"."DiscountedPrice", "r"."FeaturedDeal", "r"."HotelId", "r"."ImagesUrl", "r"."PricePerNight", "r"."RoomType", "r"."UpdatedAt"
    FROM "Rooms" AS "r"
    WHERE "r"."RoomId" = @__id_0
    LIMIT 1
) AS "t"
LEFT JOIN "Bookings" AS "b" ON "t"."RoomId" = "b"."RoomId"
ORDER BY "t"."RoomId"
2024-07-30 23:47:31.084 -03:00 [INF] Executing OkObjectResult, writing value of type 'HotelBookingSystem.Application.DTO.RoomDTO.RoomResponse'.
2024-07-30 23:47:31.089 -03:00 [INF] Executed action HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api) in 113.5333ms
2024-07-30 23:47:31.091 -03:00 [INF] Executed endpoint 'HotelBookingSystem.Api.Controllers.RoomController.GetRoomById (HotelBookingSystem.Api)'
2024-07-30 23:47:31.092 -03:00 [INF] HTTP GET /api/room/6/15 responded 200 in 142.2236 ms
2024-07-30 23:47:31.096 -03:00 [INF] Request finished HTTP/1.1 GET https://localhost:7288/api/room/6/15 - 200 null application/json; charset=utf-8 150.1264ms
